import{j as e}from"./vendor-ui-CHMJddlm.js";import{e as pe,f as he,u as ue,r}from"./vendor-react-B7WRoy5K.js";import{M as ge,T as be,a as b,P as z,b as W,L as d,u as je,c as fe}from"./vendor-maps-DSLFPks9.js";import{u as ye,a as j,R as Q,l as Ne,at as X,T as f,ae as ve,i as we,d as ke,au as Ae,av as Se,ai as q,h as G}from"./index-8Jnni3Ld.js";import"./vendor-charts-C5vizwv2.js";const Ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",Me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",Re=d.icon({iconUrl:Ce,shadowUrl:Me,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]});d.Marker.prototype.options.icon=Re;const K=t=>d.divIcon({className:"custom-marker",html:`<div style="
      background-color: ${t};
      width: 24px;
      height: 24px;
      border-radius: 50%;
      border: 3px solid white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    "></div>`,iconSize:[24,24],iconAnchor:[12,12],popupAnchor:[0,-12]}),Y={Operacional:"#22c55e","Manutencao Necessaria":"#eab308","Em Reparacao":"#f97316",Desativado:"#ef4444"},Ie={preventiva:"#3b82f6",corretiva:"#ef4444",substituicao:"#8b5cf6",inspecao:"#22c55e"};function Pe({positions:t}){const i=je();return r.useEffect(()=>{if(t.length>0){const l=d.latLngBounds(t);i.fitBounds(l,{padding:[50,50]})}},[t,i]),null}function ze({active:t,onMapClick:i}){return fe({click:l=>{t&&i(l.latlng.lat,l.latlng.lng)}}),null}const Ee=d.divIcon({className:"starting-point-marker",html:`<div style="
    background-color: #10b981;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    border: 4px solid white;
    box-shadow: 0 2px 8px rgba(0,0,0,0.4);
    display: flex;
    align-items: center;
    justify-content: center;
  "><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 8v8M8 12h8"/></svg></div>`,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]});function Be(){const{t}=ye(),i=ue(),[l,V]=r.useState([]),[x,Z]=r.useState([]),[J,E]=r.useState(!0),[B,y]=r.useState(""),[N,_]=r.useState(!0),[v,$]=r.useState(!0),[p,ee]=r.useState(""),[h,se]=r.useState(""),[te,ae]=r.useState([]),[w,re]=r.useState(null),[k,A]=r.useState(!1),[m,F]=r.useState(!1),[o,U]=r.useState([]),[S,O]=r.useState([]),[u,H]=r.useState(null),[C,T]=r.useState(null),[n,M]=r.useState(null),[g,R]=r.useState(!1),ne=[39.5,-8],ie=7;r.useEffect(()=>{D()},[p,h]);const D=async()=>{var s;E(!0),y("");try{const a=new URLSearchParams;p&&a.append("status",p),h&&a.append("municipality",h);const[c,P,de]=await Promise.all([j.get(`/map/assets?${a}`),j.get("/map/interventions?status=em_curso"),j.get("/map/statistics")]);V(c.assets||[]),Z(P.interventions||[]),re(de);const me=[...new Set((s=c.assets)==null?void 0:s.map(xe=>xe.municipality).filter(Boolean))];ae(me)}catch(a){y(a.message||"Erro ao carregar dados do mapa")}finally{E(!1)}},I=s=>{U(a=>a.includes(s)?a.filter(c=>c!==s):[...a,s])},le=async()=>{if(o.length!==0)try{const s={intervention_ids:o};n&&(s.starting_point={latitude:n.lat,longitude:n.lng});const a=await j.post("/map/route-plan",s);O(a.waypoints||[]),H(a.route_geometry||null),T({distance:a.total_distance_km,time:a.estimated_time_minutes})}catch(s){y(s.message||"Erro ao calcular rota")}},oe=()=>{U([]),O([]),H(null),T(null),F(!1),M(null),R(!1)},ce=(s,a)=>{g&&(M({lat:s,lng:a}),R(!1))},L=[...N?l.map(s=>[s.latitude,s.longitude]):[],...v?x.map(s=>[s.latitude,s.longitude]):[]];return e.jsxs("div",{className:"h-[calc(100vh-120px)] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-900 dark:text-gray-100 truncate",children:t("map.title")||"Mapa"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 hidden sm:block",children:t("map.subtitle")||"Visualizacao geografica de ativos e intervencoes"})]}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 flex-shrink-0",children:[e.jsx("button",{onClick:()=>A(!k),className:"lg:hidden p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",title:t("common.filters")||"Filtros",children:e.jsx(Q,{className:"h-5 w-5"})}),e.jsx("button",{onClick:D,className:"p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",title:t("common.refresh")||"Atualizar",children:e.jsx(Ne,{className:"h-5 w-5"})}),e.jsxs("button",{onClick:()=>F(!m),className:`inline-flex items-center px-2 sm:px-3 py-2 rounded-lg text-sm ${m?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:[e.jsx(X,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:t("map.planRoute")||"Planear Rota"})]})]})]}),B&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-400 rounded-lg",children:B}),e.jsxs("div",{className:"flex-1 flex gap-2 sm:gap-4 relative",children:[k&&e.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-[1000]",onClick:()=>A(!1)}),e.jsxs("div",{className:`
          lg:w-72 lg:relative lg:translate-x-0 lg:block lg:z-10
          fixed top-0 left-0 h-full w-72 z-[1001] transform transition-transform duration-300
          ${k?"translate-x-0":"-translate-x-full lg:translate-x-0"}
          bg-white dark:bg-gray-800 rounded-r-lg lg:rounded-lg shadow-lg lg:shadow p-4 overflow-y-auto
        `,children:[e.jsxs("div",{className:"lg:hidden flex items-center justify-between mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"font-semibold text-gray-900 dark:text-white",children:t("common.filters")||"Filtros"}),e.jsx("button",{onClick:()=>A(!1),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:e.jsx(f,{className:"h-5 w-5"})})]}),w&&e.jsxs("div",{className:"mb-4 pb-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:t("map.statistics")||"Estatisticas"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-500",children:[t("map.assetsWithGps")||"Ativos com GPS",":"]}),e.jsx("span",{className:"font-medium",children:w.assets_with_gps})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-500",children:[t("map.openInterventions")||"Intervencoes abertas",":"]}),e.jsx("span",{className:"font-medium",children:w.open_interventions})]})]})]}),e.jsxs("div",{className:"mb-4 pb-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[e.jsx(Q,{className:"h-4 w-4 mr-1"}),t("common.filters")||"Filtros"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:t("common.status")||"Estado"}),e.jsxs("select",{value:p,onChange:s=>ee(s.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700",children:[e.jsx("option",{value:"",children:t("common.all")||"Todos"}),e.jsx("option",{value:"Operacional",children:"Operacional"}),e.jsx("option",{value:"Manutencao Necessaria",children:"Manutencao Necessaria"}),e.jsx("option",{value:"Em Reparacao",children:"Em Reparacao"}),e.jsx("option",{value:"Desativado",children:"Desativado"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:t("map.municipality")||"Municipio"}),e.jsxs("select",{value:h,onChange:s=>se(s.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700",children:[e.jsx("option",{value:"",children:t("common.all")||"Todos"}),te.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]})]}),e.jsxs("div",{className:"mb-4 pb-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[e.jsx(ve,{className:"h-4 w-4 mr-1"}),t("map.layers")||"Camadas"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:N,onChange:s=>_(s.target.checked),className:"rounded border-gray-300"}),e.jsx(we,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{className:"text-sm",children:[t("map.assets")||"Ativos"," (",l.length,")"]})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:v,onChange:s=>$(s.target.checked),className:"rounded border-gray-300"}),e.jsx(ke,{className:"h-4 w-4 text-orange-600"}),e.jsxs("span",{className:"text-sm",children:[t("map.interventions")||"Intervencoes"," (",x.length,")"]})]})]})]}),m&&e.jsxs("div",{className:"mb-4 pb-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[e.jsx(X,{className:"h-4 w-4 mr-1"}),t("map.routePlanning")||"Planeamento de Rota"]}),e.jsxs("div",{className:"mb-3 p-2 bg-gray-50 dark:bg-gray-700 rounded",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-300",children:t("map.startingPoint")||"Ponto de Partida"}),n&&e.jsx("button",{onClick:()=>M(null),className:"text-red-500 hover:text-red-700",children:e.jsx(f,{className:"h-3 w-3"})})]}),n?e.jsxs("p",{className:"text-xs text-green-600",children:[n.lat.toFixed(6),", ",n.lng.toFixed(6)]}):e.jsxs("button",{onClick:()=>R(!0),className:`w-full text-xs px-2 py-1.5 rounded flex items-center justify-center gap-1 ${g?"bg-green-600 text-white":"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 hover:bg-green-200"}`,children:[e.jsx(Ae,{className:"h-3 w-3"}),g?t("map.selectStartingPoint")||"Clique no mapa...":t("map.selectStartingPoint")||"Selecionar no mapa"]})]}),e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:t("map.selectInterventions")||"Clique nas intervencoes no mapa para adicionar a rota"}),e.jsx("div",{className:"space-y-1 mb-3 max-h-32 overflow-y-auto",children:o.map((s,a)=>{const c=x.find(P=>P.id===s);return c?e.jsxs("div",{className:"flex items-center justify-between text-xs bg-gray-50 dark:bg-gray-700 p-1 rounded",children:[e.jsxs("span",{children:[a+1,". ",c.asset_serial]}),e.jsx("button",{onClick:()=>I(s),className:"text-red-500 hover:text-red-700",children:e.jsx(f,{className:"h-3 w-3"})})]},s):null})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:le,disabled:o.length===0,className:"flex-1 inline-flex items-center justify-center px-2 py-1.5 text-xs bg-blue-600 text-white rounded disabled:opacity-50",children:[e.jsx(Se,{className:"h-3 w-3 mr-1"}),t("map.calculate")||"Calcular"]}),e.jsx("button",{onClick:oe,className:"px-2 py-1.5 text-xs bg-gray-200 dark:bg-gray-600 rounded",children:t("common.clear")||"Limpar"})]}),C&&e.jsxs("div",{className:"mt-3 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[t("map.totalDistance")||"Distancia total",":"]}),e.jsxs("span",{className:"font-medium",children:[C.distance," km"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[t("map.estimatedTime")||"Tempo estimado",":"]}),e.jsxs("span",{className:"font-medium",children:[C.time," min"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:t("map.legend")||"Legenda"}),e.jsx("div",{className:"space-y-1 text-xs",children:Object.entries(Y).map(([s,a])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a}}),e.jsx("span",{children:s})]},s))})]})]}),e.jsx("div",{className:"flex-1 rounded-lg overflow-hidden shadow relative z-0",children:J?e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-100 dark:bg-gray-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500",children:t("common.loading")||"A carregar..."})]})}):e.jsxs(ge,{center:ne,zoom:ie,className:"h-full w-full",style:{minHeight:"300px"},children:[e.jsx(be,{attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),L.length>0&&e.jsx(Pe,{positions:L}),e.jsx(ze,{active:g,onMapClick:ce}),n&&e.jsx(b,{position:[n.lat,n.lng],icon:Ee,children:e.jsx(z,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:t("map.startingPoint")||"Ponto de Partida"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[n.lat.toFixed(6),", ",n.lng.toFixed(6)]})]})})}),N&&l.map(s=>e.jsx(b,{position:[s.latitude,s.longitude],icon:K(Y[s.status]||"#6b7280"),children:e.jsx(z,{children:e.jsxs("div",{className:"min-w-[200px]",children:[e.jsx("h4",{className:"font-semibold text-sm mb-1",children:s.serial_number}),e.jsxs("div",{className:"text-xs space-y-1 text-gray-600",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[t("map.status")||"Estado",":"]})," ",s.status]}),s.model&&e.jsxs("p",{children:[e.jsxs("strong",{children:[t("map.model")||"Modelo",":"]})," ",s.model]}),s.manufacturer&&e.jsxs("p",{children:[e.jsxs("strong",{children:[t("map.manufacturer")||"Fabricante",":"]})," ",s.manufacturer]}),s.street_address&&e.jsxs("p",{children:[e.jsxs("strong",{children:[t("map.address")||"Morada",":"]})," ",s.street_address]}),s.municipality&&e.jsxs("p",{children:[e.jsxs("strong",{children:[t("map.municipality")||"Municipio",":"]})," ",s.municipality]})]}),e.jsxs("div",{className:"mt-2 flex gap-1",children:[e.jsxs("button",{onClick:()=>i(`/assets/${s.serial_number}`),className:"text-xs px-2 py-1 bg-blue-600 text-white rounded",children:[e.jsx(q,{className:"h-3 w-3 inline mr-1"}),t("common.view")||"Ver"]}),e.jsxs("button",{onClick:()=>i(`/interventions/new?asset=${s.serial_number}`),className:"text-xs px-2 py-1 bg-green-600 text-white rounded",children:[e.jsx(G,{className:"h-3 w-3 inline mr-1"}),t("map.newIntervention")||"Intervencao"]})]})]})})},`asset-${s.id}`)),v&&x.map(s=>e.jsx(b,{position:[s.latitude,s.longitude],icon:K(Ie[s.intervention_type]||"#6b7280"),eventHandlers:{click:()=>{m&&I(s.id)}},children:e.jsx(z,{children:e.jsxs("div",{className:"min-w-[200px]",children:[e.jsxs("h4",{className:"font-semibold text-sm mb-1",children:[s.asset_serial,o.includes(s.id)&&e.jsxs("span",{className:"ml-1 text-blue-600",children:["#",o.indexOf(s.id)+1]})]}),e.jsxs("div",{className:"text-xs space-y-1 text-gray-600",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[t("map.type")||"Tipo",":"]})," ",s.intervention_type]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("map.status")||"Estado",":"]})," ",s.status]}),s.problem_description&&e.jsxs("p",{children:[e.jsxs("strong",{children:[t("map.problem")||"Problema",":"]})," ",s.problem_description.substring(0,50),"..."]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("map.createdBy")||"Criado por",":"]})," ",s.created_by_name]})]}),e.jsxs("div",{className:"mt-2 flex gap-1",children:[e.jsxs("button",{onClick:()=>i(`/interventions/${s.id}`),className:"text-xs px-2 py-1 bg-blue-600 text-white rounded",children:[e.jsx(q,{className:"h-3 w-3 inline mr-1"}),t("common.view")||"Ver"]}),m&&e.jsx("button",{onClick:()=>I(s.id),className:`text-xs px-2 py-1 rounded ${o.includes(s.id)?"bg-red-600 text-white":"bg-green-600 text-white"}`,children:o.includes(s.id)?e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"h-3 w-3 inline mr-1"}),t("common.remove")||"Remover"]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-3 w-3 inline mr-1"}),t("map.addToRoute")||"Adicionar"]})})]})]})})},`intervention-${s.id}`)),u&&u.coordinates&&u.coordinates.length>0?e.jsx(W,{positions:u.coordinates.map(s=>[s[1],s[0]]),color:"#3b82f6",weight:5,opacity:.8}):S.length>1&&e.jsx(W,{positions:S.map(s=>[s.latitude,s.longitude]),color:"#3b82f6",weight:4,opacity:.7,dashArray:"10, 10"}),S.map((s,a)=>e.jsx(b,{position:[s.latitude,s.longitude],icon:d.divIcon({className:"route-number",html:`<div style="
                      background-color: #3b82f6;
                      color: white;
                      width: 20px;
                      height: 20px;
                      border-radius: 50%;
                      display: flex;
                      align-items: center;
                      justify-content: center;
                      font-size: 11px;
                      font-weight: bold;
                      border: 2px solid white;
                      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
                    ">${a+1}</div>`,iconSize:[20,20],iconAnchor:[10,10]})},`waypoint-${s.id}`))]})})]})]})}function De(){return e.jsx(pe,{children:e.jsx(he,{index:!0,element:e.jsx(Be,{})})})}export{De as default};
