import{j as e}from"./vendor-ui-CHMJddlm.js";import{r as d}from"./vendor-react-B7WRoy5K.js";import{u as le,a as b,L as R,ak as u,w as ne,a2 as v,W as ie,f as U,aA as H,aB as L,y as q,d as de,aC as ce,aD as oe,aE as xe,o as W,aF as ge,q as me,n as he,aG as ye,aH as J,i as be,b as pe,aI as ue,aJ as je,aK as Ne}from"./index-BmyZt_nq.js";import"./vendor-charts-C5vizwv2.js";const k=({title:t,value:h,subtitle:x,icon:w,trend:g,trendValue:l,color:_="blue"})=>{const c={blue:"bg-blue-50 dark:bg-blue-900/20 text-blue-600",green:"bg-green-50 dark:bg-green-900/20 text-green-600",orange:"bg-orange-50 dark:bg-orange-900/20 text-orange-600",red:"bg-red-50 dark:bg-red-900/20 text-red-600",purple:"bg-purple-50 dark:bg-purple-900/20 text-purple-600"};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:`p-3 rounded-lg ${c[_]}`,children:w}),g&&l&&e.jsxs("div",{className:`flex items-center gap-1 text-sm ${g==="up"?"text-green-600":g==="down"?"text-red-600":"text-gray-500"}`,children:[g==="up"?e.jsx(pe,{className:"h-4 w-4"}):g==="down"?e.jsx(ue,{className:"h-4 w-4"}):null,l]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:t}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mt-1",children:h}),x&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:x})]})]})},X=({value:t,color:h="blue",label:x})=>e.jsxs("div",{className:"w-full",children:[x&&e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:x}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:[t.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full bg-${h}-600 rounded-full transition-all duration-500`,style:{width:`${Math.min(t,100)}%`}})})]}),fe=t=>({pt:"pt-PT",en:"en-GB",fr:"fr-FR",de:"de-DE"})[t]||"en-GB",Ce=()=>{const{t,i18n:h}=le(),x=fe(h.language),[w,g]=d.useState(!0),[l,_]=d.useState(null),[c,C]=d.useState("kpis"),[m,E]=d.useState({start:new Date(Date.now()-365*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[P,T]=d.useState(""),[y,Q]=d.useState([]),[V,F]=d.useState(!1),[i,M]=d.useState(null),[Y,A]=d.useState(!1),[j,K]=d.useState(""),[Z,p]=d.useState(!1),[z,B]=d.useState(!1),[$,N]=d.useState("");d.useEffect(()=>{I()},[m]),d.useEffect(()=>{c==="predictions"?O():c==="weather"&&S()},[c]);const I=async()=>{g(!0),T("");try{const a=await b.get(`/analytics/kpis?start_date=${m.start}&end_date=${m.end}`);_(a)}catch(a){T(a.message||t("errors.SERVER_ERROR"))}finally{g(!1)}},O=async()=>{F(!0);try{const a=await b.get("/analytics/ml/predict-maintenance");Q(a.predictions||[])}catch(a){console.error("Error loading predictions:",a)}finally{F(!1)}},S=async()=>{A(!0);try{const[a,r,s]=await Promise.all([b.get("/analytics/weather").catch(()=>({configured:!1})),b.get("/analytics/weather/forecast").catch(()=>({configured:!1,forecast:[]})),b.get("/analytics/weather/alerts").catch(()=>({configured:!1,alerts:[]}))]);if(!a.configured){p(!0),M(null);return}M({configured:!0,locations:a.locations||[],forecast:r.forecast||[],alerts:s.alerts||[],maintenance_windows:r.maintenance_windows||[],city:r.city,fetched_at:a.fetched_at}),p(!1)}catch(a){console.error("Error loading weather:",a),p(!0)}finally{A(!1)}},ee=async()=>{var a,r,s;if(!j.trim()){N(t("analytics.apiKeyRequired"));return}B(!0),N("");try{const n=await b.post("/analytics/weather/config",{api_key:j.trim()});console.log("Weather config saved:",n),p(!1),K(""),await S()}catch(n){console.error("Error saving weather config:",n);const o=((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.error)||((s=n.data)==null?void 0:s.error)||n.message||t("analytics.apiKeyInvalid");N(o)}finally{B(!1)}},ae=a=>{switch(a){case"low":return"text-green-600 bg-green-50 dark:bg-green-900/20";case"medium":return"text-yellow-600 bg-yellow-50 dark:bg-yellow-900/20";case"high":return"text-orange-600 bg-orange-50 dark:bg-orange-900/20";case"critical":return"text-red-600 bg-red-50 dark:bg-red-900/20";default:return"text-gray-600 bg-gray-50"}},D=a=>{const r=a.toLowerCase();return r.includes("rain")||r.includes("chuva")?e.jsx(je,{className:"h-6 w-6 text-blue-500"}):r.includes("cloud")||r.includes("nuvem")?e.jsx(L,{className:"h-6 w-6 text-gray-500"}):r.includes("wind")||r.includes("vento")?e.jsx(J,{className:"h-6 w-6 text-teal-500"}):e.jsx(Ne,{className:"h-6 w-6 text-yellow-500"})},G=async a=>{try{const s=await(await fetch(`/api/analytics/export?type=${a}&start_date=${m.start}&end_date=${m.end}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).blob(),n=window.URL.createObjectURL(s),o=document.createElement("a");o.href=n,o.download=`analytics_${a}_${new Date().toISOString().split("T")[0]}.csv`,o.click(),window.URL.revokeObjectURL(n)}catch(r){console.error("Export error:",r)}};if(w)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(R,{size:"lg"})});if(P)return e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6 text-center",children:[e.jsx(u,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),e.jsx("p",{className:"text-red-700 dark:text-red-300",children:P}),e.jsx("button",{onClick:I,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:t("common.refresh")})]});const te=()=>V?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(R,{size:"lg"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-lg",children:e.jsx(W,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:t("analytics.lowRisk")}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:y.filter(a=>a.priority==="low").length})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg",children:e.jsx(u,{className:"h-5 w-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:t("analytics.mediumRisk")}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:y.filter(a=>a.priority==="medium").length})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:e.jsx(u,{className:"h-5 w-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:t("analytics.highRisk")}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:y.filter(a=>a.priority==="high").length})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg",children:e.jsx(me,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:t("analytics.criticalRisk")}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:y.filter(a=>a.priority==="critical").length})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{className:"h-5 w-5 text-purple-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("analytics.maintenancePredictions")})]}),e.jsx("button",{onClick:O,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(v,{className:"h-4 w-4"})})]}),y.length>0?e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:y.sort((a,r)=>r.risk_score-a.risk_score).slice(0,20).map(a=>e.jsx("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.serial_number}),a.product_reference&&e.jsx("p",{className:"text-sm text-gray-500",children:a.product_reference}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsxs("span",{className:"text-xs px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded",children:[a.total_interventions," ",t("analytics.interventions")]}),a.corrective_count>0&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-300 rounded",children:[a.corrective_count," ",t("analytics.corrective")]}),a.days_until_maintenance!==void 0&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-300 rounded",children:[a.days_until_maintenance," ",t("common.days")]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:a.recommendation})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${ae(a.priority)}`,children:[a.risk_score,"%"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 capitalize",children:t(`analytics.risk.${a.priority}`)}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[a.failure_probability,"% ",t("analytics.failureProbability")]})]})]})},a.asset_id))}):e.jsx("div",{className:"p-8 text-center text-gray-500",children:t("analytics.noPredictions")})]})]}),se=()=>{var r;if(Y)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(R,{size:"lg"})});if(Z||!i||!i.configured)return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 border border-gray-200 dark:border-gray-700 max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx(L,{className:"h-12 w-12 text-blue-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:t("analytics.configureWeather")}),e.jsx("p",{className:"text-gray-500 mt-2",children:t("analytics.weatherApiDescription")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"OpenWeatherMap API Key"}),e.jsx("input",{type:"text",value:j,onChange:s=>{K(s.target.value),N("")},placeholder:"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",className:`w-full px-3 py-2 border rounded-lg bg-white dark:bg-gray-800 ${$?"border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600"}`}),$&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:$})]}),e.jsx("button",{onClick:ee,disabled:!j.trim()||z,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2",children:z?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"h-4 w-4 animate-spin"}),t("common.saving")]}):t("common.save")}),e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:[t("analytics.getApiKeyHint")," ",e.jsx("a",{href:"https://openweathermap.org/api",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"openweathermap.org"})]})]})]});const a=(r=i.locations)==null?void 0:r[0];return e.jsxs("div",{className:"space-y-6",children:[a&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("analytics.currentWeather")}),e.jsx("p",{className:"text-sm text-gray-500",children:a.location})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:S,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",title:t("common.refresh"),children:e.jsx(v,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>p(!0),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(he,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[D(a.description),e.jsxs("div",{children:[e.jsxs("p",{className:"text-4xl font-bold text-gray-900 dark:text-gray-100",children:[Math.round(a.temperature),"Â°C"]}),e.jsx("p",{className:"text-gray-500 capitalize",children:a.description})]}),e.jsxs("div",{className:"ml-auto grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(ye,{className:"h-5 w-5 text-red-500 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-500",children:t("analytics.humidity")}),e.jsxs("p",{className:"font-medium",children:[a.humidity,"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(J,{className:"h-5 w-5 text-teal-500 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-500",children:t("analytics.wind")}),e.jsxs("p",{className:"font-medium",children:[a.wind_speed," m/s"]})]})]})]})]}),(!i.locations||i.locations.length===0)&&e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-xl p-6 border border-yellow-200 dark:border-yellow-700 text-center",children:[e.jsx(be,{className:"h-8 w-8 text-yellow-600 mx-auto mb-3"}),e.jsx("h3",{className:"font-medium text-yellow-700 dark:text-yellow-400 mb-2",children:t("analytics.noLocations")}),e.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-300",children:t("analytics.noLocationsDescription")})]}),i.alerts&&i.alerts.length>0&&e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-xl p-4 border border-orange-200 dark:border-orange-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(u,{className:"h-5 w-5 text-orange-600"}),e.jsx("h3",{className:"font-medium text-orange-700 dark:text-orange-400",children:t("analytics.weatherAlerts")})]}),e.jsx("div",{className:"space-y-3",children:i.alerts.map((s,n)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white/50 dark:bg-gray-800/50 rounded-lg",children:[e.jsx("div",{className:`flex-shrink-0 w-2 h-2 mt-2 rounded-full ${s.severity==="high"?"bg-red-500":s.severity==="medium"?"bg-orange-500":"bg-yellow-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:s.message}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.location," â€¢ ",s.asset_count," ativos"]}),e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400 mt-1",children:s.recommendation})]})]},n))})]}),i.locations&&i.locations.length>1&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:t("analytics.allLocations")}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.locations.map((s,n)=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[D(s.description),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:s.location}),e.jsx("p",{className:"text-sm text-gray-500 capitalize",children:s.description})]}),e.jsxs("p",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:[Math.round(s.temperature),"Â°C"]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-500",children:[e.jsxs("span",{children:["ðŸ’§ ",s.humidity,"%"]}),e.jsxs("span",{children:["ðŸ’¨ ",s.wind_speed," m/s"]})]})]},n))})]}),i.forecast&&i.forecast.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("analytics.forecast5Days")}),i.city&&e.jsx("span",{className:"text-sm text-gray-500",children:i.city})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-3",children:i.forecast.slice(0,8).map((s,n)=>{const o=new Date(s.datetime),f=s.rain_probability<30&&s.wind_speed<10;return e.jsxs("div",{className:`text-center p-3 rounded-lg ${f?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700":"bg-gray-50 dark:bg-gray-700/50"}`,children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:o.toLocaleDateString(x,{weekday:"short"})}),e.jsx("p",{className:"text-xs text-gray-500",children:o.toLocaleTimeString(x,{hour:"2-digit",minute:"2-digit"})}),e.jsx("div",{className:"my-2",children:D(s.description)}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:[Math.round(s.temperature),"Â°"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[Math.round(s.rain_probability),"% ðŸŒ§ï¸"]}),f&&e.jsxs("span",{className:"text-[10px] text-green-600 mt-1 block",children:["âœ“ ",t("analytics.goodForMaintenance")]})]},n)})})]}),i.maintenance_windows&&i.maintenance_windows.length>0&&e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-xl p-6 border border-green-200 dark:border-green-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(W,{className:"h-5 w-5 text-green-600"}),e.jsx("h2",{className:"text-lg font-semibold text-green-800 dark:text-green-300",children:t("analytics.goodMaintenanceWindows")})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:i.maintenance_windows.slice(0,6).map((s,n)=>{const o=new Date(s.datetime);return e.jsxs("div",{className:"p-3 bg-white/50 dark:bg-gray-800/50 rounded-lg",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:o.toLocaleDateString(x,{weekday:"long",day:"numeric",month:"short"})}),e.jsx("p",{className:"text-sm text-gray-500",children:o.toLocaleTimeString(x,{hour:"2-digit",minute:"2-digit"})}),e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1 capitalize",children:[s.conditions," â€¢ ",Math.round(s.temperature),"Â°C"]})]},n)})})]})]})};return!l&&c==="kpis"?null:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:t("analytics.title")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:t("analytics.description")})]}),e.jsx("div",{className:"flex items-center gap-3",children:c==="kpis"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2",children:[e.jsx(ne,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"date",value:m.start,onChange:a=>E(r=>({...r,start:a.target.value})),className:"bg-transparent border-none text-sm focus:outline-none"}),e.jsx("span",{className:"text-gray-400",children:"-"}),e.jsx("input",{type:"date",value:m.end,onChange:a=>E(r=>({...r,end:a.target.value})),className:"bg-transparent border-none text-sm focus:outline-none"})]}),e.jsx("button",{onClick:I,className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600",children:e.jsx(v,{className:"h-5 w-5 text-gray-600 dark:text-gray-300"})}),e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),t("common.export")]}),e.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg hidden group-hover:block z-10",children:[e.jsx("button",{onClick:()=>G("interventions"),className:"block w-full px-4 py-2 text-left hover:bg-gray-50 dark:hover:bg-gray-700 text-sm",children:t("analytics.exportInterventions")}),e.jsx("button",{onClick:()=>G("costs"),className:"block w-full px-4 py-2 text-left hover:bg-gray-50 dark:hover:bg-gray-700 text-sm",children:t("analytics.exportCosts")})]})]})]})})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("nav",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>C("kpis"),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${c==="kpis"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(U,{className:"h-4 w-4"}),t("analytics.kpis")]}),e.jsxs("button",{onClick:()=>C("predictions"),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${c==="predictions"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(H,{className:"h-4 w-4"}),t("analytics.mlPredictions")]}),e.jsxs("button",{onClick:()=>C("weather"),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${c==="weather"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(L,{className:"h-4 w-4"}),t("analytics.weather")]})]})}),c==="predictions"&&te(),c==="weather"&&se(),c==="kpis"&&l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(k,{title:t("analytics.mtbf"),value:`${l.mtbf.days.toFixed(0)} ${t("common.days")}`,subtitle:`${l.mtbf.value.toFixed(0)} ${t("analytics.hours")}`,icon:e.jsx(q,{className:"h-6 w-6"}),color:"blue"}),e.jsx(k,{title:t("analytics.mttr"),value:`${l.mttr.value.toFixed(1)}h`,subtitle:`${l.mttr.repairs_count} ${t("analytics.repairs")}`,icon:e.jsx(de,{className:"h-6 w-6"}),color:"orange"}),e.jsx(k,{title:t("analytics.availability"),value:`${l.availability.current.toFixed(1)}%`,subtitle:`${l.availability.operational_assets}/${l.availability.total_assets} ${t("analytics.operational")}`,icon:e.jsx(ce,{className:"h-6 w-6"}),color:"green"}),e.jsx(k,{title:t("analytics.totalCosts"),value:`â‚¬${l.costs.total.toLocaleString()}`,subtitle:`â‚¬${l.costs.cost_per_asset.toFixed(0)}/${t("analytics.perAsset")}`,icon:e.jsx(oe,{className:"h-6 w-6"}),color:"purple"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(xe,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("analytics.efficiencyMetrics")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(X,{value:l.efficiency.completion_rate,color:"green",label:t("analytics.completionRate")}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsx(W,{className:"h-6 w-6 text-green-600 mx-auto"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mt-2",children:l.efficiency.completed}),e.jsx("p",{className:"text-sm text-gray-500",children:t("analytics.completed")})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:[e.jsx(q,{className:"h-6 w-6 text-orange-600 mx-auto"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mt-2",children:l.efficiency.pending+l.efficiency.in_progress}),e.jsx("p",{className:"text-sm text-gray-500",children:t("analytics.pending")})]})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:t("analytics.avgCompletionTime")}),e.jsxs("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:[l.efficiency.avg_completion_hours.toFixed(1),"h"]})]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ge,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("analytics.assetHealth")})]}),e.jsxs("div",{className:"space-y-4",children:[l.asset_health.by_status.map((a,r)=>{const s=l.asset_health.by_status.reduce((f,re)=>f+re.count,0),n=a.count/s*100,o=["green","yellow","orange","red","gray"];return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-32 text-sm text-gray-600 dark:text-gray-400 truncate",children:a.status||t("analytics.unknown")}),e.jsx("div",{className:"flex-1",children:e.jsx(X,{value:n,color:o[r]||"blue"})}),e.jsx("div",{className:"w-12 text-right text-sm font-medium text-gray-900 dark:text-gray-100",children:a.count})]},r)}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"text-center p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsx("p",{className:"text-lg font-bold text-red-600",children:l.asset_health.warranty_expired}),e.jsx("p",{className:"text-xs text-gray-500",children:t("analytics.warrantyExpired")})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:[e.jsx("p",{className:"text-lg font-bold text-orange-600",children:l.asset_health.warranty_expiring_30d}),e.jsx("p",{className:"text-xs text-gray-500",children:t("analytics.warrantyExpiring")})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("p",{className:"text-lg font-bold text-blue-600",children:l.asset_health.maintenance_due_7d}),e.jsx("p",{className:"text-xs text-gray-500",children:t("analytics.maintenanceDue")})]})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(U,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("analytics.interventionsByType")})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:l.interventions_summary.by_type.map((a,r)=>{const s=["blue","green","orange","purple"],n={preventiva:t("interventions.type.preventiva"),corretiva:t("interventions.type.corretiva"),substituicao:t("interventions.type.substituicao"),inspecao:t("interventions.type.inspecao")};return e.jsxs("div",{className:`p-4 rounded-lg bg-${s[r%4]}-50 dark:bg-${s[r%4]}-900/20`,children:[e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:a.count}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:n[a.intervention_type]||a.intervention_type})]},a.intervention_type)})})]}),l.interventions_summary.top_assets.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(u,{className:"h-5 w-5 text-orange-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("analytics.topAssets")})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"#"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:t("assets.serialNumber")}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-500",children:t("analytics.interventionCount")})]})}),e.jsx("tbody",{children:l.interventions_summary.top_assets.map((a,r)=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-700/50",children:[e.jsx("td",{className:"py-3 px-4 text-sm text-gray-500",children:r+1}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"font-mono text-sm text-blue-600 hover:underline cursor-pointer",children:a.serial_number})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 rounded-full text-sm font-medium",children:a.intervention_count})})]},a.serial_number))})]})})]}),l.costs.by_type.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(DollarSign,{className:"h-5 w-5 text-purple-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("analytics.costsByType")})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:t("common.type")}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-500",children:t("analytics.count")}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-500",children:t("analytics.totalCost")}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-500",children:t("analytics.avgCost")})]})}),e.jsx("tbody",{children:l.costs.by_type.map(a=>{var r,s;return e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-700/50",children:[e.jsx("td",{className:"py-3 px-4 font-medium text-gray-900 dark:text-gray-100",children:a.intervention_type}),e.jsx("td",{className:"py-3 px-4 text-right text-gray-600 dark:text-gray-400",children:a.count}),e.jsxs("td",{className:"py-3 px-4 text-right font-medium text-gray-900 dark:text-gray-100",children:["â‚¬",((r=a.total)==null?void 0:r.toLocaleString())||0]}),e.jsxs("td",{className:"py-3 px-4 text-right text-gray-600 dark:text-gray-400",children:["â‚¬",((s=a.average)==null?void 0:s.toFixed(2))||0]})]},a.intervention_type)})})]})})]})]})]})};export{Ce as default};
