import{j as e}from"./vendor-ui-CHMJddlm.js";import{u as L,r as n}from"./vendor-react-B7WRoy5K.js";import{u as $}from"./useApi-DtY82GH_.js";import{u as F,m as T,r as q,a0 as I,al as U,p as W,B as p,J as z,n as J,f as R,O as X,ap as Z,P as G,d as K,c as Q,I as C,aq as V,ar as N,S as v}from"./index-Dn60TOEo.js";import"./vendor-charts-C5vizwv2.js";const Y={LayoutDashboard:V,Package:C,Users:Q,Wrench:K,BookOpen:G,HardHat:Z,FileText:X,BarChart3:R,Settings:J,Database:z,Building2:I},k={base:p,pro:W,premium:U,enterprise:I},w={base:"bg-gray-100 text-gray-800 border-gray-300",pro:"bg-blue-100 text-blue-800 border-blue-300",premium:"bg-purple-100 text-purple-800 border-purple-300",enterprise:"bg-amber-100 text-amber-800 border-amber-300"};function ce(){const M=L(),u=$(),{t:r}=F(),[c,d]=n.useState({}),[h,_]=n.useState({}),[S,b]=n.useState(!0),[j,y]=n.useState(!1),[ee,se]=n.useState(null),[P,o]=n.useState(!1),f=n.useCallback(async()=>{b(!0);try{const s=await u.get("/settings/plans");d(s.plans||{}),_(s.modules||{})}catch(s){console.error("Error loading plans:",s)}finally{b(!1)}},[u]);n.useEffect(()=>{f()},[f]);const B=(s,t)=>{d(a=>{const l=a[s];if(!l)return a;const m=l.modules||[];let x;return m.includes("*")?x=Object.keys(h).filter(g=>g!==t):m.includes(t)?x=m.filter(g=>g!==t):x=[...m,t],{...a,[s]:{...l,modules:x}}}),o(!0)},O=s=>{d(t=>{const a=t[s];return a?{...t,[s]:{...a,modules:["*"]}}:t}),o(!0)},A=s=>{d(t=>{const a=t[s];return a?{...t,[s]:{...a,modules:[]}}:t}),o(!0)},D=(s,t)=>{const a=c[s];return a?a.modules.includes("*")?!0:a.modules.includes(t):!1},E=async()=>{y(!0);try{for(const s of Object.keys(c))await u.put(`/settings/plans/${s}/modules`,{modules:c[s].modules});o(!1),alert(r("plans.allConfigsSaved"))}catch(s){alert(s.message||r("common.error"))}finally{y(!1)}};if(S)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const i=["base","pro","premium","enterprise"].filter(s=>c[s]).map(s=>({id:s,...c[s]})),H=Object.values(h);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>M("/tenants"),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:e.jsx(T,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r("plans.title")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:r("plans.subtitle")})]})]}),P&&e.jsxs("button",{onClick:E,disabled:j,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(q,{className:"w-4 h-4"}),r(j?"common.saving":"plans.saveChanges")]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900 dark:text-white w-48",children:r("plans.module")}),i.map(s=>{const t=k[s.id]||p;return e.jsx("th",{className:"px-4 py-3 text-center min-w-[140px]",children:e.jsxs("div",{className:`inline-flex flex-col items-center gap-1 px-3 py-2 rounded-lg border ${w[s.id]}`,children:[e.jsx(t,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:s.name})]})},s.id)})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:H.map(s=>{const t=Y[s.icon]||C;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:e.jsx(t,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.description})]})]})}),i.map(a=>{const l=D(a.id,s.id);return e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("button",{onClick:()=>B(a.id,s.id),className:`p-2 rounded-full transition-colors ${l?"bg-green-100 text-green-600 hover:bg-green-200":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,children:l?e.jsx(N,{className:"w-5 h-5"}):e.jsx(v,{className:"w-5 h-5"})})},a.id)})]},s.id)})}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white",children:r("plans.quickActions")}),i.map(s=>e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("button",{onClick:()=>O(s.id),className:"px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200",title:r("plans.allModules"),children:r("plans.allModules")}),e.jsx("button",{onClick:()=>A(s.id),className:"px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200",title:r("plans.noModules"),children:r("plans.noModules")})]})},s.id))]})})]})})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:i.map(s=>{const t=k[s.id]||p,a=s.limits||{};return e.jsxs("div",{className:`p-4 rounded-lg border ${w[s.id]}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(t,{className:"w-5 h-5"}),e.jsx("h3",{className:"font-semibold",children:s.name})]}),e.jsx("p",{className:"text-sm opacity-80 mb-3",children:s.description}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsxs("span",{className:"opacity-70",children:[r("plans.limits.users"),":"]})," ",e.jsx("span",{className:"font-medium",children:a.max_users===-1?r("plans.limits.unlimited"):a.max_users})]}),e.jsxs("p",{children:[e.jsxs("span",{className:"opacity-70",children:[r("plans.limits.assets"),":"]})," ",e.jsx("span",{className:"font-medium",children:a.max_assets===-1?r("plans.limits.unlimited"):a.max_assets})]}),e.jsxs("p",{children:[e.jsxs("span",{className:"opacity-70",children:[r("plans.limits.storage"),":"]})," ",e.jsx("span",{className:"font-medium",children:a.max_storage_mb===-1?r("plans.limits.unlimited"):`${a.max_storage_mb} MB`})]})]})]},s.id)})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:r("plans.features")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-500",children:"Funcionalidade"}),i.map(s=>e.jsx("th",{className:"px-4 py-2 text-center text-sm font-medium",children:s.name},s.id))]})}),e.jsx("tbody",{className:"divide-y dark:divide-gray-700",children:["2fa","api_access","export_excel","export_pdf","custom_branding","route_planner","analytics","priority_support"].map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm capitalize",children:s.replace(/_/g," ")}),i.map(t=>{var l;const a=(l=t.features)==null?void 0:l[s];return e.jsx("td",{className:"px-4 py-2 text-center",children:a?e.jsx(N,{className:"w-4 h-4 text-green-500 mx-auto"}):e.jsx(v,{className:"w-4 h-4 text-gray-300 mx-auto"})},t.id)})]},s))})]})})]})]})}export{ce as default};
