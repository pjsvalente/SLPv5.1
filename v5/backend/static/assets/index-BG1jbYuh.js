import{j as e}from"./vendor-ui-DmBNdSVN.js";import{e as q,f,u as N,r as l,i as P}from"./vendor-react-T01qSRBw.js";import{u as k}from"./useApi-BZgsW-zB.js";import{D as B}from"./DataTable-BFLdDrRn.js";import{F as x}from"./FormField-Ba39GSYY.js";import{C as R}from"./ConfirmDialog-DLv6qdaJ.js";import{S as v}from"./StatusBadge-BozaLod_.js";import{c as w,u as C,j as U,U as A,l as I,W as D,X as _}from"./index-DX4T9gyP.js";import{M as T}from"./mail-CCqt-l2e.js";import{P as E}from"./pen-square-ehJY7iAC.js";import{T as W}from"./trash-2-y9WDQfsX.js";import{P as H}from"./plus-BY_IWypP.js";import{A as L}from"./arrow-left-BlslNQWr.js";import{S as X}from"./save-CEd9fzU7.js";import"./search-DEoTBd8T.js";import"./chevron-up-By3FJq8K.js";import"./crosshair-D6RNT-R-.js";import"./vendor-charts-Bs1Eue5i.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=w("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=w("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=w("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);function pe(){return e.jsxs(q,{children:[e.jsx(f,{index:!0,element:e.jsx(K,{})}),e.jsx(f,{path:"new",element:e.jsx(M,{})}),e.jsx(f,{path:":id",element:e.jsx(O,{})}),e.jsx(f,{path:":id/edit",element:e.jsx(M,{})})]})}function K(){var S;const{t:a}=C(),h=N(),o=k(),[g,i]=l.useState([]),[p,u]=l.useState(null),[j,b]=l.useState(!0),[n,d]=l.useState({tipo:"",ativo:"",search:""}),[c,y]=l.useState({open:!1,technician:null}),s=l.useCallback(async()=>{b(!0);try{const t=new URLSearchParams;n.tipo&&t.append("tipo",n.tipo),n.ativo&&t.append("ativo",n.ativo),n.search&&t.append("search",n.search);const m=await o.get(`/technicians?${t.toString()}`);i(m.technicians||[])}catch(t){console.error("Error loading technicians:",t)}finally{b(!1)}},[o,n]),r=l.useCallback(async()=>{try{const t=await o.get("/technicians/stats");u(t)}catch(t){console.error("Error loading stats:",t)}},[o]);l.useEffect(()=>{s(),r()},[s,r]);const z=async()=>{if(c.technician)try{await o.delete(`/technicians/${c.technician.id}`),y({open:!1,technician:null}),s(),r()}catch(t){alert(t.message||a("technicians.deactivateError"))}},F=[{key:"nome",label:a("technicians.name"),sortable:!0,render:t=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"font-medium",children:t.nome})]})},{key:"tipo",label:a("common.type"),sortable:!0,render:t=>e.jsx(v,{status:t.tipo,colorMap:{interno:"blue",externo:"purple"}})},{key:"empresa",label:a("technicians.company"),sortable:!0,render:t=>t.empresa||"-"},{key:"especialidade",label:a("technicians.specialization"),sortable:!0,render:t=>t.especialidade||"-"},{key:"telefone",label:a("technicians.phone"),render:t=>e.jsxs("div",{className:"text-sm",children:[t.telefone&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"w-3 h-3"}),t.telefone]}),t.email&&e.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx(T,{className:"w-3 h-3"}),t.email]})]})},{key:"ativo",label:a("common.status"),render:t=>e.jsx(v,{status:t.ativo?"ativo":"inativo",colorMap:{ativo:"green",inativo:"gray"}})},{key:"actions",label:a("common.actions"),render:t=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:m=>{m.stopPropagation(),h(`/technicians/${t.id}/edit`)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Editar",children:e.jsx(E,{className:"w-4 h-4"})}),e.jsx("button",{onClick:m=>{m.stopPropagation(),y({open:!0,technician:t})},className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Desativar",disabled:!t.ativo,children:e.jsx(W,{className:"w-4 h-4"})})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a("technicians.title")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:a("technicians.subtitle")})]}),e.jsxs("button",{onClick:()=>h("/technicians/new"),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(H,{className:"w-4 h-4"}),a("technicians.newTechnician")]})]}),p&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:e.jsx(A,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("common.total")}),e.jsx("p",{className:"text-xl font-bold",children:p.total})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900 rounded-lg",children:e.jsx(J,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("technicians.internal")}),e.jsx("p",{className:"text-xl font-bold",children:p.internos})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900 rounded-lg",children:e.jsx(I,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("technicians.external")}),e.jsx("p",{className:"text-xl font-bold",children:p.externos})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-teal-100 dark:bg-teal-900 rounded-lg",children:e.jsx(D,{className:"w-5 h-5 text-teal-600 dark:text-teal-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("common.active")}),e.jsx("p",{className:"text-xl font-bold",children:p.ativos})]})]})})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(x,{name:"search",label:a("common.search"),type:"text",value:n.search,onChange:t=>d(m=>({...m,search:t})),placeholder:a("technicians.searchPlaceholder")}),e.jsx(x,{name:"tipo",label:a("common.type"),type:"select",value:n.tipo,onChange:t=>d(m=>({...m,tipo:t})),options:[{value:"",label:a("common.all")},{value:"interno",label:a("technicians.internal")},{value:"externo",label:a("technicians.external")}]}),e.jsx(x,{name:"ativo",label:a("common.status"),type:"select",value:n.ativo,onChange:t=>d(m=>({...m,ativo:t})),options:[{value:"",label:a("common.all")},{value:"true",label:a("common.active")},{value:"false",label:a("common.inactive")}]})]})}),e.jsx(B,{columns:F,data:g,loading:j,onRowClick:t=>h(`/technicians/${t.id}`),emptyMessage:a("technicians.noTechniciansFound")}),e.jsx(R,{open:c.open,title:a("technicians.deactivateTechnician"),message:a("technicians.confirmDeactivate",{name:(S=c.technician)==null?void 0:S.nome}),confirmLabel:a("technicians.deactivate"),variant:"danger",onConfirm:z,onCancel:()=>y({open:!1,technician:null})})]})}function M(){const{t:a}=C(),h=N(),{id:o}=P(),g=k(),i=!!o,[p,u]=l.useState(!1),[j,b]=l.useState(!1),[n,d]=l.useState({nome:"",tipo:"interno",empresa:"",telefone:"",email:"",especialidade:"",notas:"",ativo:!0});l.useEffect(()=>{i&&c()},[o]);const c=async()=>{u(!0);try{const s=await g.get(`/technicians/${o}`);d({nome:s.nome||"",tipo:s.tipo||"interno",empresa:s.empresa||"",telefone:s.telefone||"",email:s.email||"",especialidade:s.especialidade||"",notas:s.notas||"",ativo:!!s.ativo})}catch(s){console.error("Error loading technician:",s),h("/technicians")}finally{u(!1)}},y=async s=>{if(s.preventDefault(),!n.nome.trim()){alert(a("technicians.nameRequired"));return}b(!0);try{i?await g.put(`/technicians/${o}`,n):await g.post("/technicians",n),h("/technicians")}catch(r){alert(r.message||a("technicians.saveError"))}finally{b(!1)}};return p?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>h("/technicians"),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:e.jsx(L,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a(i?"technicians.editTechnician":"technicians.newTechnician")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:a(i?"technicians.editSubtitle":"technicians.newSubtitle")})]})]}),e.jsxs("form",{onSubmit:y,className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(x,{name:"nome",label:a("technicians.name"),type:"text",value:n.nome,onChange:s=>d(r=>({...r,nome:s})),required:!0,placeholder:a("technicians.namePlaceholder")}),e.jsx(x,{name:"tipo",label:a("common.type"),type:"select",value:n.tipo,onChange:s=>d(r=>({...r,tipo:s})),required:!0,options:[{value:"interno",label:a("technicians.internal")},{value:"externo",label:a("technicians.external")}]}),e.jsx(x,{name:"empresa",label:a("technicians.company"),type:"text",value:n.empresa,onChange:s=>d(r=>({...r,empresa:s})),placeholder:a("technicians.companyPlaceholder")}),e.jsx(x,{name:"especialidade",label:a("technicians.specialization"),type:"text",value:n.especialidade,onChange:s=>d(r=>({...r,especialidade:s})),placeholder:a("technicians.specializationPlaceholder")}),e.jsx(x,{name:"telefone",label:a("technicians.phone"),type:"text",value:n.telefone,onChange:s=>d(r=>({...r,telefone:s})),placeholder:a("technicians.phonePlaceholder")}),e.jsx(x,{name:"email",label:a("technicians.email"),type:"text",value:n.email,onChange:s=>d(r=>({...r,email:s})),placeholder:a("technicians.emailPlaceholder")}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(x,{name:"notas",label:a("technicians.notes"),type:"textarea",value:n.notas,onChange:s=>d(r=>({...r,notas:s})),placeholder:a("technicians.notesPlaceholder")})}),i&&e.jsx(x,{name:"ativo",label:a("common.status"),type:"checkbox",value:n.ativo,onChange:s=>d(r=>({...r,ativo:s}))})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("button",{type:"button",onClick:()=>h("/technicians"),className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 dark:border-gray-600 dark:hover:bg-gray-700",children:[e.jsx(_,{className:"w-4 h-4"}),a("common.cancel")]}),e.jsxs("button",{type:"submit",disabled:j,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(X,{className:"w-4 h-4"}),a(j?"common.saving":"common.save")]})]})]})]})}function O(){const{t:a}=C(),h=N(),{id:o}=P(),g=k(),[i,p]=l.useState(null),[u,j]=l.useState([]),[b,n]=l.useState(!0);l.useEffect(()=>{d()},[o]);const d=async()=>{n(!0);try{const[c,y]=await Promise.all([g.get(`/technicians/${o}`),g.get(`/technicians/${o}/interventions`)]);p(c),j(y.interventions||[])}catch(c){console.error("Error loading technician:",c),h("/technicians")}finally{n(!1)}};return b?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>h("/technicians"),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:e.jsx(L,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.nome}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(v,{status:i.tipo,colorMap:{interno:"blue",externo:"purple"}}),e.jsx(v,{status:i.ativo?"ativo":"inativo",colorMap:{ativo:"green",inativo:"gray"}})]})]})]}),e.jsxs("button",{onClick:()=>h(`/technicians/${o}/edit`),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(E,{className:"w-4 h-4"}),a("common.edit")]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:a("technicians.information")}),e.jsxs("dl",{className:"space-y-4",children:[i.empresa&&e.jsxs("div",{children:[e.jsxs("dt",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),a("technicians.company")]}),e.jsx("dd",{className:"font-medium",children:i.empresa})]}),i.especialidade&&e.jsxs("div",{children:[e.jsxs("dt",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),a("technicians.specialization")]}),e.jsx("dd",{className:"font-medium",children:i.especialidade})]}),i.telefone&&e.jsxs("div",{children:[e.jsxs("dt",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),a("technicians.phone")]}),e.jsx("dd",{className:"font-medium",children:i.telefone})]}),i.email&&e.jsxs("div",{children:[e.jsxs("dt",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),a("technicians.email")]}),e.jsx("dd",{className:"font-medium",children:i.email})]}),i.notas&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("technicians.notes")}),e.jsx("dd",{className:"text-sm",children:i.notas})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("technicians.totalInterventions")}),e.jsx("dd",{className:"font-medium",children:i.intervention_count||0})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:a("technicians.recentInterventions")}),u.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:a("technicians.noInterventions")}):e.jsx("div",{className:"space-y-3",children:u.slice(0,10).map(c=>e.jsxs("div",{onClick:()=>h(`/interventions/${c.id}`),className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:c.numero}),e.jsx("p",{className:"text-sm text-gray-500",children:c.asset_serial})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(v,{status:c.estado,colorMap:{em_curso:"yellow",concluida:"green",cancelada:"red"}}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(c.created_at).toLocaleDateString("pt-PT")})]})]},c.id))})]})]})]}):null}export{pe as default};
