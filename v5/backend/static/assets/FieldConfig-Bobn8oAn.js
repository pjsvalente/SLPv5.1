import{j as e}from"./vendor-ui-DmBNdSVN.js";import{r as i}from"./vendor-react-T01qSRBw.js";import{c as A,u as L,a as b,X as T}from"./index-DX4T9gyP.js";import{L as x}from"./loader-2-BqBRpLPY.js";import{S as f}from"./save-CEd9fzU7.js";import{S as $}from"./shield-DpwBZlpO.js";import{T as E}from"./tag-GNtTSsPx.js";import{C as I}from"./check-BAKatE_F.js";import"./vendor-charts-Bs1Eue5i.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=A("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),B=()=>{const{t:a,i18n:u}=L(),[n,o]=i.useState([]),[v,j]=i.useState(!0),[c,h]=i.useState(!1),[g,m]=i.useState({type:"",text:""}),[p,l]=i.useState(!1);i.useEffect(()=>{k()},[u.language]);const k=async()=>{try{const s=await b.get(`/settings/fields?lang=${u.language}`);o(s.fields||[]),l(!1)}catch(s){m({type:"error",text:s.message})}finally{j(!1)}},N=s=>{o(r=>r.map(t=>t.field_name===s&&!t.is_system?{...t,is_active:t.is_active?0:1}:t)),l(!0)},_=s=>{o(r=>r.map(t=>t.field_name===s?{...t,is_required:t.is_required?0:1}:t)),l(!0)},y=async()=>{h(!0);try{const s=n.map(r=>({field_name:r.field_name,is_active:r.is_active,is_required:r.is_required}));await b.put("/settings/fields/bulk",{fields:s}),m({type:"success",text:a("settings.saved")}),l(!1)}catch(s){m({type:"error",text:s.message})}finally{h(!1)}},w={identification:a("settings.categories.identification"),specifications:a("settings.categories.specifications"),installation:a("settings.categories.installation"),warranty:a("settings.categories.warranty"),maintenance:a("settings.categories.maintenance"),equipment:a("settings.categories.equipment"),other:a("settings.categories.other")},d={};n.forEach(s=>{const r=s.field_category||"other";d[r]||(d[r]=[]),d[r].push(s)});const C=["identification","specifications","installation","warranty","maintenance","equipment","other"],S=n.filter(s=>s.is_active).length,q=n.length;return v?e.jsx("div",{className:"flex justify-center p-8",children:e.jsx(x,{className:"h-8 w-8 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:a("settings.fieldConfigDescription")||"Ativar/desativar campos visíveis no formulário de ativos"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:[S," / ",q," ",a("settings.fieldsActive")||"campos ativos"]})]}),e.jsxs("button",{onClick:y,disabled:c||!p,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[c?e.jsx(x,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(f,{className:"h-4 w-4 mr-2"}),a("common.save")]})]}),g.text&&e.jsx("div",{className:`p-4 rounded-lg ${g.type==="error"?"bg-red-50 text-red-700 dark:bg-red-900/20 dark:text-red-400":"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-400"}`,children:g.text}),C.map(s=>{const r=d[s];return!r||r.length===0?null:e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 uppercase tracking-wide",children:w[s]||s}),e.jsx("div",{className:"space-y-2",children:r.sort((t,F)=>t.field_order-F.field_order).map(t=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border transition-colors ${t.is_active?"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-600":"bg-gray-100 dark:bg-gray-800/50 border-gray-200 dark:border-gray-700 opacity-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t.is_system?e.jsx($,{className:"h-5 w-5 text-blue-500",title:a("settings.systemField")}):e.jsx(E,{className:"h-5 w-5 text-gray-400",title:a("settings.customField")}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${t.is_active?"text-gray-900 dark:text-gray-100":"text-gray-500 dark:text-gray-400"}`,children:t.field_label}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:e.jsx("code",{className:"bg-gray-100 dark:bg-gray-700 px-1 rounded",children:t.field_name})})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[t.is_active===1&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.is_required===1,onChange:()=>_(t.field_name),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("common.required")})]}),t.is_system?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400 rounded-full text-sm",children:[e.jsx(M,{className:"h-3 w-3"}),a("settings.alwaysActive")]}):e.jsx("button",{onClick:()=>N(t.field_name),className:`flex items-center gap-1 px-3 py-1 rounded-full text-sm transition-colors ${t.is_active?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 hover:bg-green-200":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300 hover:bg-gray-300"}`,children:t.is_active?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-3 w-3"}),a("settings.fieldActive")||"Ativo"]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"h-3 w-3"}),a("settings.fieldInactive")||"Inativo"]})})]})]},t.id))})]},s)}),p&&e.jsx("div",{className:"sticky bottom-4 flex justify-end",children:e.jsxs("button",{onClick:y,disabled:c,className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white rounded-lg shadow-lg hover:bg-blue-700 disabled:opacity-50",children:[c?e.jsx(x,{className:"h-5 w-5 mr-2 animate-spin"}):e.jsx(f,{className:"h-5 w-5 mr-2"}),a("settings.saveChanges")||"Guardar Alterações"]})})]})};export{B as default};
