import{j as e}from"./vendor-ui-DmBNdSVN.js";import{u as H,r as n}from"./vendor-react-T01qSRBw.js";import{u as L}from"./useApi-BZgsW-zB.js";import{u as T,l as C,D as U,S as W,i as Z,F as q,H as z,h as R,W as X,U as G,P as M,o as J,X as N}from"./index-DX4T9gyP.js";import{A as K}from"./arrow-left-BlslNQWr.js";import{S as Q}from"./save-CEd9fzU7.js";import{C as V}from"./crown-BJAdtDIH.js";import{Z as Y}from"./zap-CXbW9AZj.js";import{S as g}from"./shield-DpwBZlpO.js";import{C as v}from"./check-BAKatE_F.js";import"./vendor-charts-Bs1Eue5i.js";const I={LayoutDashboard:J,Package:M,Users:G,Wrench:X,BookOpen:R,HardHat:z,FileText:q,BarChart3:Z,Settings:W,Database:U,Building2:C},k={base:g,pro:Y,premium:V,enterprise:C},w={base:"bg-gray-100 text-gray-800 border-gray-300",pro:"bg-blue-100 text-blue-800 border-blue-300",premium:"bg-purple-100 text-purple-800 border-purple-300",enterprise:"bg-amber-100 text-amber-800 border-amber-300"};function pe(){const S=H(),u=L(),{t:r}=T(),[d,c]=n.useState({}),[h,_]=n.useState({}),[P,b]=n.useState(!0),[j,y]=n.useState(!1),[ee,se]=n.useState(null),[A,o]=n.useState(!1),f=n.useCallback(async()=>{b(!0);try{const s=await u.get("/settings/plans");c(s.plans||{}),_(s.modules||{})}catch(s){console.error("Error loading plans:",s)}finally{b(!1)}},[u]);n.useEffect(()=>{f()},[f]);const O=(s,t)=>{c(a=>{const l=a[s];if(!l)return a;const m=l.modules||[];let x;return m.includes("*")?x=Object.keys(h).filter(p=>p!==t):m.includes(t)?x=m.filter(p=>p!==t):x=[...m,t],{...a,[s]:{...l,modules:x}}}),o(!0)},E=s=>{c(t=>{const a=t[s];return a?{...t,[s]:{...a,modules:["*"]}}:t}),o(!0)},$=s=>{c(t=>{const a=t[s];return a?{...t,[s]:{...a,modules:[]}}:t}),o(!0)},B=(s,t)=>{const a=d[s];return a?a.modules.includes("*")?!0:a.modules.includes(t):!1},D=async()=>{y(!0);try{for(const s of Object.keys(d))await u.put(`/settings/plans/${s}/modules`,{modules:d[s].modules});o(!1),alert(r("plans.allConfigsSaved"))}catch(s){alert(s.message||r("common.error"))}finally{y(!1)}};if(P)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const i=["base","pro","premium","enterprise"].filter(s=>d[s]).map(s=>({id:s,...d[s]})),F=Object.values(h);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>S("/tenants"),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:e.jsx(K,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r("plans.title")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:r("plans.subtitle")})]})]}),A&&e.jsxs("button",{onClick:D,disabled:j,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Q,{className:"w-4 h-4"}),r(j?"common.saving":"plans.saveChanges")]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900 dark:text-white w-48",children:r("plans.module")}),i.map(s=>{const t=k[s.id]||g;return e.jsx("th",{className:"px-4 py-3 text-center min-w-[140px]",children:e.jsxs("div",{className:`inline-flex flex-col items-center gap-1 px-3 py-2 rounded-lg border ${w[s.id]}`,children:[e.jsx(t,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:s.name})]})},s.id)})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:F.map(s=>{const t=I[s.icon]||M;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:e.jsx(t,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.description})]})]})}),i.map(a=>{const l=B(a.id,s.id);return e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("button",{onClick:()=>O(a.id,s.id),className:`p-2 rounded-full transition-colors ${l?"bg-green-100 text-green-600 hover:bg-green-200":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,children:l?e.jsx(v,{className:"w-5 h-5"}):e.jsx(N,{className:"w-5 h-5"})})},a.id)})]},s.id)})}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white",children:r("plans.quickActions")}),i.map(s=>e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("button",{onClick:()=>E(s.id),className:"px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200",title:r("plans.allModules"),children:r("plans.allModules")}),e.jsx("button",{onClick:()=>$(s.id),className:"px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200",title:r("plans.noModules"),children:r("plans.noModules")})]})},s.id))]})})]})})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:i.map(s=>{const t=k[s.id]||g,a=s.limits||{};return e.jsxs("div",{className:`p-4 rounded-lg border ${w[s.id]}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(t,{className:"w-5 h-5"}),e.jsx("h3",{className:"font-semibold",children:s.name})]}),e.jsx("p",{className:"text-sm opacity-80 mb-3",children:s.description}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsxs("span",{className:"opacity-70",children:[r("plans.limits.users"),":"]})," ",e.jsx("span",{className:"font-medium",children:a.max_users===-1?r("plans.limits.unlimited"):a.max_users})]}),e.jsxs("p",{children:[e.jsxs("span",{className:"opacity-70",children:[r("plans.limits.assets"),":"]})," ",e.jsx("span",{className:"font-medium",children:a.max_assets===-1?r("plans.limits.unlimited"):a.max_assets})]}),e.jsxs("p",{children:[e.jsxs("span",{className:"opacity-70",children:[r("plans.limits.storage"),":"]})," ",e.jsx("span",{className:"font-medium",children:a.max_storage_mb===-1?r("plans.limits.unlimited"):`${a.max_storage_mb} MB`})]})]})]},s.id)})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:r("plans.features")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-500",children:"Funcionalidade"}),i.map(s=>e.jsx("th",{className:"px-4 py-2 text-center text-sm font-medium",children:s.name},s.id))]})}),e.jsx("tbody",{className:"divide-y dark:divide-gray-700",children:["2fa","api_access","export_excel","export_pdf","custom_branding","route_planner","analytics","priority_support"].map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm capitalize",children:s.replace(/_/g," ")}),i.map(t=>{var l;const a=(l=t.features)==null?void 0:l[s];return e.jsx("td",{className:"px-4 py-2 text-center",children:a?e.jsx(v,{className:"w-4 h-4 text-green-500 mx-auto"}):e.jsx(N,{className:"w-4 h-4 text-gray-300 mx-auto"})},t.id)})]},s))})]})})]})]})}export{pe as default};
