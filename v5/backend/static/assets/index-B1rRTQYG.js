import{j as e}from"./vendor-ui-CHMJddlm.js";import{r as d}from"./vendor-react-B7WRoy5K.js";import{k as x,u as ie,a as b,L,A as j,C as A}from"./index-B4kLCiXA.js";import{C as de}from"./calendar-8jGHqjMi.js";import{R as k}from"./refresh-cw-CbbB-drX.js";import{D as ce}from"./download-DXjuMDGl.js";import{B as U}from"./bar-chart-3-Bc28TW2b.js";import{C as q}from"./clock-DpJe5Urc.js";import{W as oe}from"./wrench-Cf_knTNj.js";import{X as xe}from"./x-circle-BP9tHLxf.js";import{S as ge}from"./settings-BtyuFtXW.js";import{M as me}from"./map-pin-jrFkuuJh.js";import{T as he}from"./trending-up-COuwOQMY.js";import"./vendor-charts-C5vizwv2.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=x("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=x("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=x("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=x("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=x("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=x("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=x("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=x("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=x("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=x("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=x("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]),w=({title:a,value:y,subtitle:g,icon:_,trend:m,trendValue:l,color:C="blue"})=>{const c={blue:"bg-blue-50 dark:bg-blue-900/20 text-blue-600",green:"bg-green-50 dark:bg-green-900/20 text-green-600",orange:"bg-orange-50 dark:bg-orange-900/20 text-orange-600",red:"bg-red-50 dark:bg-red-900/20 text-red-600",purple:"bg-purple-50 dark:bg-purple-900/20 text-purple-600"};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:`p-3 rounded-lg ${c[C]}`,children:_}),m&&l&&e.jsxs("div",{className:`flex items-center gap-1 text-sm ${m==="up"?"text-green-600":m==="down"?"text-red-600":"text-gray-500"}`,children:[m==="up"?e.jsx(he,{className:"h-4 w-4"}):m==="down"?e.jsx(fe,{className:"h-4 w-4"}):null,l]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:a}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mt-1",children:y}),g&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:g})]})]})},J=({value:a,color:y="blue",label:g})=>e.jsxs("div",{className:"w-full",children:[g&&e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:g}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:[a.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full bg-${y}-600 rounded-full transition-all duration-500`,style:{width:`${Math.min(a,100)}%`}})})]}),ve=a=>({pt:"pt-PT",en:"en-GB",fr:"fr-FR",de:"de-DE"})[a]||"en-GB",Pe=()=>{const{t:a,i18n:y}=ie(),g=ve(y.language),[_,m]=d.useState(!0),[l,C]=d.useState(null),[c,S]=d.useState("kpis"),[h,T]=d.useState({start:new Date(Date.now()-365*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[E,P]=d.useState(""),[p,Q]=d.useState([]),[Y,F]=d.useState(!1),[i,z]=d.useState(null),[ee,I]=d.useState(!1),[N,B]=d.useState(""),[te,u]=d.useState(!1),[H,K]=d.useState(!1),[$,f]=d.useState("");d.useEffect(()=>{M()},[h]),d.useEffect(()=>{c==="predictions"?O():c==="weather"&&R()},[c]);const M=async()=>{m(!0),P("");try{const t=await b.get(`/analytics/kpis?start_date=${h.start}&end_date=${h.end}`);C(t)}catch(t){P(t.message||a("errors.SERVER_ERROR"))}finally{m(!1)}},O=async()=>{F(!0);try{const t=await b.get("/analytics/ml/predict-maintenance");Q(t.predictions||[])}catch(t){console.error("Error loading predictions:",t)}finally{F(!1)}},R=async()=>{I(!0);try{const[t,s,r]=await Promise.all([b.get("/analytics/weather").catch(()=>({configured:!1})),b.get("/analytics/weather/forecast").catch(()=>({configured:!1,forecast:[]})),b.get("/analytics/weather/alerts").catch(()=>({configured:!1,alerts:[]}))]);if(!t.configured){u(!0),z(null);return}z({configured:!0,locations:t.locations||[],forecast:s.forecast||[],alerts:r.alerts||[],maintenance_windows:s.maintenance_windows||[],city:s.city,fetched_at:t.fetched_at}),u(!1)}catch(t){console.error("Error loading weather:",t),u(!0)}finally{I(!1)}},ae=async()=>{var t,s,r;if(!N.trim()){f(a("analytics.apiKeyRequired"));return}K(!0),f("");try{const n=await b.post("/analytics/weather/config",{api_key:N.trim()});console.log("Weather config saved:",n),u(!1),B(""),await R()}catch(n){console.error("Error saving weather config:",n);const o=((s=(t=n.response)==null?void 0:t.data)==null?void 0:s.error)||((r=n.data)==null?void 0:r.error)||n.message||a("analytics.apiKeyInvalid");f(o)}finally{K(!1)}},re=t=>{switch(t){case"low":return"text-green-600 bg-green-50 dark:bg-green-900/20";case"medium":return"text-yellow-600 bg-yellow-50 dark:bg-yellow-900/20";case"high":return"text-orange-600 bg-orange-50 dark:bg-orange-900/20";case"critical":return"text-red-600 bg-red-50 dark:bg-red-900/20";default:return"text-gray-600 bg-gray-50"}},D=t=>{const s=t.toLowerCase();return s.includes("rain")||s.includes("chuva")?e.jsx(pe,{className:"h-6 w-6 text-blue-500"}):s.includes("cloud")||s.includes("nuvem")?e.jsx(W,{className:"h-6 w-6 text-gray-500"}):s.includes("wind")||s.includes("vento")?e.jsx(V,{className:"h-6 w-6 text-teal-500"}):e.jsx(ue,{className:"h-6 w-6 text-yellow-500"})},G=async t=>{try{const r=await(await fetch(`/api/analytics/export?type=${t}&start_date=${h.start}&end_date=${h.end}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).blob(),n=window.URL.createObjectURL(r),o=document.createElement("a");o.href=n,o.download=`analytics_${t}_${new Date().toISOString().split("T")[0]}.csv`,o.click(),window.URL.revokeObjectURL(n)}catch(s){console.error("Export error:",s)}};if(_)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(L,{size:"lg"})});if(E)return e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6 text-center",children:[e.jsx(j,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),e.jsx("p",{className:"text-red-700 dark:text-red-300",children:E}),e.jsx("button",{onClick:M,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:a("common.refresh")})]});const se=()=>Y?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(L,{size:"lg"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-lg",children:e.jsx(A,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:a("analytics.lowRisk")}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:p.filter(t=>t.priority==="low").length})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg",children:e.jsx(j,{className:"h-5 w-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:a("analytics.mediumRisk")}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:p.filter(t=>t.priority==="medium").length})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:e.jsx(j,{className:"h-5 w-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:a("analytics.highRisk")}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:p.filter(t=>t.priority==="high").length})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg",children:e.jsx(xe,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:a("analytics.criticalRisk")}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:p.filter(t=>t.priority==="critical").length})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"h-5 w-5 text-purple-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a("analytics.maintenancePredictions")})]}),e.jsx("button",{onClick:O,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(k,{className:"h-4 w-4"})})]}),p.length>0?e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:p.sort((t,s)=>s.risk_score-t.risk_score).slice(0,20).map(t=>e.jsx("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:t.serial_number}),t.product_reference&&e.jsx("p",{className:"text-sm text-gray-500",children:t.product_reference}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsxs("span",{className:"text-xs px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded",children:[t.total_interventions," ",a("analytics.interventions")]}),t.corrective_count>0&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-300 rounded",children:[t.corrective_count," ",a("analytics.corrective")]}),t.days_until_maintenance!==void 0&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-300 rounded",children:[t.days_until_maintenance," ",a("common.days")]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:t.recommendation})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${re(t.priority)}`,children:[t.risk_score,"%"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 capitalize",children:a(`analytics.risk.${t.priority}`)}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[t.failure_probability,"% ",a("analytics.failureProbability")]})]})]})},t.asset_id))}):e.jsx("div",{className:"p-8 text-center text-gray-500",children:a("analytics.noPredictions")})]})]}),le=()=>{var s;if(ee)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(L,{size:"lg"})});if(te||!i||!i.configured)return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 border border-gray-200 dark:border-gray-700 max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx(W,{className:"h-12 w-12 text-blue-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:a("analytics.configureWeather")}),e.jsx("p",{className:"text-gray-500 mt-2",children:a("analytics.weatherApiDescription")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"OpenWeatherMap API Key"}),e.jsx("input",{type:"text",value:N,onChange:r=>{B(r.target.value),f("")},placeholder:"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",className:`w-full px-3 py-2 border rounded-lg bg-white dark:bg-gray-800 ${$?"border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600"}`}),$&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:$})]}),e.jsx("button",{onClick:ae,disabled:!N.trim()||H,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2",children:H?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"h-4 w-4 animate-spin"}),a("common.saving")]}):a("common.save")}),e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:[a("analytics.getApiKeyHint")," ",e.jsx("a",{href:"https://openweathermap.org/api",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"openweathermap.org"})]})]})]});const t=(s=i.locations)==null?void 0:s[0];return e.jsxs("div",{className:"space-y-6",children:[t&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a("analytics.currentWeather")}),e.jsx("p",{className:"text-sm text-gray-500",children:t.location})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:R,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",title:a("common.refresh"),children:e.jsx(k,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>u(!0),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(ge,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[D(t.description),e.jsxs("div",{children:[e.jsxs("p",{className:"text-4xl font-bold text-gray-900 dark:text-gray-100",children:[Math.round(t.temperature),"Â°C"]}),e.jsx("p",{className:"text-gray-500 capitalize",children:t.description})]}),e.jsxs("div",{className:"ml-auto grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Ne,{className:"h-5 w-5 text-red-500 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-500",children:a("analytics.humidity")}),e.jsxs("p",{className:"font-medium",children:[t.humidity,"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(V,{className:"h-5 w-5 text-teal-500 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-500",children:a("analytics.wind")}),e.jsxs("p",{className:"font-medium",children:[t.wind_speed," m/s"]})]})]})]})]}),(!i.locations||i.locations.length===0)&&e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-xl p-6 border border-yellow-200 dark:border-yellow-700 text-center",children:[e.jsx(me,{className:"h-8 w-8 text-yellow-600 mx-auto mb-3"}),e.jsx("h3",{className:"font-medium text-yellow-700 dark:text-yellow-400 mb-2",children:a("analytics.noLocations")}),e.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-300",children:a("analytics.noLocationsDescription")})]}),i.alerts&&i.alerts.length>0&&e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-xl p-4 border border-orange-200 dark:border-orange-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(j,{className:"h-5 w-5 text-orange-600"}),e.jsx("h3",{className:"font-medium text-orange-700 dark:text-orange-400",children:a("analytics.weatherAlerts")})]}),e.jsx("div",{className:"space-y-3",children:i.alerts.map((r,n)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white/50 dark:bg-gray-800/50 rounded-lg",children:[e.jsx("div",{className:`flex-shrink-0 w-2 h-2 mt-2 rounded-full ${r.severity==="high"?"bg-red-500":r.severity==="medium"?"bg-orange-500":"bg-yellow-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:r.message}),e.jsxs("p",{className:"text-xs text-gray-500",children:[r.location," â€¢ ",r.asset_count," ativos"]}),e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400 mt-1",children:r.recommendation})]})]},n))})]}),i.locations&&i.locations.length>1&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:a("analytics.allLocations")}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.locations.map((r,n)=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[D(r.description),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:r.location}),e.jsx("p",{className:"text-sm text-gray-500 capitalize",children:r.description})]}),e.jsxs("p",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:[Math.round(r.temperature),"Â°C"]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-500",children:[e.jsxs("span",{children:["ðŸ’§ ",r.humidity,"%"]}),e.jsxs("span",{children:["ðŸ’¨ ",r.wind_speed," m/s"]})]})]},n))})]}),i.forecast&&i.forecast.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a("analytics.forecast5Days")}),i.city&&e.jsx("span",{className:"text-sm text-gray-500",children:i.city})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-3",children:i.forecast.slice(0,8).map((r,n)=>{const o=new Date(r.datetime),v=r.rain_probability<30&&r.wind_speed<10;return e.jsxs("div",{className:`text-center p-3 rounded-lg ${v?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700":"bg-gray-50 dark:bg-gray-700/50"}`,children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:o.toLocaleDateString(g,{weekday:"short"})}),e.jsx("p",{className:"text-xs text-gray-500",children:o.toLocaleTimeString(g,{hour:"2-digit",minute:"2-digit"})}),e.jsx("div",{className:"my-2",children:D(r.description)}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:[Math.round(r.temperature),"Â°"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[Math.round(r.rain_probability),"% ðŸŒ§ï¸"]}),v&&e.jsxs("span",{className:"text-[10px] text-green-600 mt-1 block",children:["âœ“ ",a("analytics.goodForMaintenance")]})]},n)})})]}),i.maintenance_windows&&i.maintenance_windows.length>0&&e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-xl p-6 border border-green-200 dark:border-green-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(A,{className:"h-5 w-5 text-green-600"}),e.jsx("h2",{className:"text-lg font-semibold text-green-800 dark:text-green-300",children:a("analytics.goodMaintenanceWindows")})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:i.maintenance_windows.slice(0,6).map((r,n)=>{const o=new Date(r.datetime);return e.jsxs("div",{className:"p-3 bg-white/50 dark:bg-gray-800/50 rounded-lg",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:o.toLocaleDateString(g,{weekday:"long",day:"numeric",month:"short"})}),e.jsx("p",{className:"text-sm text-gray-500",children:o.toLocaleTimeString(g,{hour:"2-digit",minute:"2-digit"})}),e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1 capitalize",children:[r.conditions," â€¢ ",Math.round(r.temperature),"Â°C"]})]},n)})})]})]})};return!l&&c==="kpis"?null:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:a("analytics.title")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:a("analytics.description")})]}),e.jsx("div",{className:"flex items-center gap-3",children:c==="kpis"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2",children:[e.jsx(de,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"date",value:h.start,onChange:t=>T(s=>({...s,start:t.target.value})),className:"bg-transparent border-none text-sm focus:outline-none"}),e.jsx("span",{className:"text-gray-400",children:"-"}),e.jsx("input",{type:"date",value:h.end,onChange:t=>T(s=>({...s,end:t.target.value})),className:"bg-transparent border-none text-sm focus:outline-none"})]}),e.jsx("button",{onClick:M,className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600",children:e.jsx(k,{className:"h-5 w-5 text-gray-600 dark:text-gray-300"})}),e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),a("common.export")]}),e.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg hidden group-hover:block z-10",children:[e.jsx("button",{onClick:()=>G("interventions"),className:"block w-full px-4 py-2 text-left hover:bg-gray-50 dark:hover:bg-gray-700 text-sm",children:a("analytics.exportInterventions")}),e.jsx("button",{onClick:()=>G("costs"),className:"block w-full px-4 py-2 text-left hover:bg-gray-50 dark:hover:bg-gray-700 text-sm",children:a("analytics.exportCosts")})]})]})]})})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("nav",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>S("kpis"),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${c==="kpis"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(U,{className:"h-4 w-4"}),a("analytics.kpis")]}),e.jsxs("button",{onClick:()=>S("predictions"),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${c==="predictions"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(Z,{className:"h-4 w-4"}),a("analytics.mlPredictions")]}),e.jsxs("button",{onClick:()=>S("weather"),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${c==="weather"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(W,{className:"h-4 w-4"}),a("analytics.weather")]})]})}),c==="predictions"&&se(),c==="weather"&&le(),c==="kpis"&&l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(w,{title:a("analytics.mtbf"),value:`${l.mtbf.days.toFixed(0)} ${a("common.days")}`,subtitle:`${l.mtbf.value.toFixed(0)} ${a("analytics.hours")}`,icon:e.jsx(q,{className:"h-6 w-6"}),color:"blue"}),e.jsx(w,{title:a("analytics.mttr"),value:`${l.mttr.value.toFixed(1)}h`,subtitle:`${l.mttr.repairs_count} ${a("analytics.repairs")}`,icon:e.jsx(oe,{className:"h-6 w-6"}),color:"orange"}),e.jsx(w,{title:a("analytics.availability"),value:`${l.availability.current.toFixed(1)}%`,subtitle:`${l.availability.operational_assets}/${l.availability.total_assets} ${a("analytics.operational")}`,icon:e.jsx(ye,{className:"h-6 w-6"}),color:"green"}),e.jsx(w,{title:a("analytics.totalCosts"),value:`â‚¬${l.costs.total.toLocaleString()}`,subtitle:`â‚¬${l.costs.cost_per_asset.toFixed(0)}/${a("analytics.perAsset")}`,icon:e.jsx(X,{className:"h-6 w-6"}),color:"purple"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(je,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a("analytics.efficiencyMetrics")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(J,{value:l.efficiency.completion_rate,color:"green",label:a("analytics.completionRate")}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsx(A,{className:"h-6 w-6 text-green-600 mx-auto"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mt-2",children:l.efficiency.completed}),e.jsx("p",{className:"text-sm text-gray-500",children:a("analytics.completed")})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:[e.jsx(q,{className:"h-6 w-6 text-orange-600 mx-auto"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mt-2",children:l.efficiency.pending+l.efficiency.in_progress}),e.jsx("p",{className:"text-sm text-gray-500",children:a("analytics.pending")})]})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:a("analytics.avgCompletionTime")}),e.jsxs("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:[l.efficiency.avg_completion_hours.toFixed(1),"h"]})]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(be,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a("analytics.assetHealth")})]}),e.jsxs("div",{className:"space-y-4",children:[l.asset_health.by_status.map((t,s)=>{const r=l.asset_health.by_status.reduce((v,ne)=>v+ne.count,0),n=t.count/r*100,o=["green","yellow","orange","red","gray"];return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-32 text-sm text-gray-600 dark:text-gray-400 truncate",children:t.status||a("analytics.unknown")}),e.jsx("div",{className:"flex-1",children:e.jsx(J,{value:n,color:o[s]||"blue"})}),e.jsx("div",{className:"w-12 text-right text-sm font-medium text-gray-900 dark:text-gray-100",children:t.count})]},s)}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"text-center p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsx("p",{className:"text-lg font-bold text-red-600",children:l.asset_health.warranty_expired}),e.jsx("p",{className:"text-xs text-gray-500",children:a("analytics.warrantyExpired")})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:[e.jsx("p",{className:"text-lg font-bold text-orange-600",children:l.asset_health.warranty_expiring_30d}),e.jsx("p",{className:"text-xs text-gray-500",children:a("analytics.warrantyExpiring")})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("p",{className:"text-lg font-bold text-blue-600",children:l.asset_health.maintenance_due_7d}),e.jsx("p",{className:"text-xs text-gray-500",children:a("analytics.maintenanceDue")})]})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(U,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a("analytics.interventionsByType")})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:l.interventions_summary.by_type.map((t,s)=>{const r=["blue","green","orange","purple"],n={preventiva:a("interventions.type.preventiva"),corretiva:a("interventions.type.corretiva"),substituicao:a("interventions.type.substituicao"),inspecao:a("interventions.type.inspecao")};return e.jsxs("div",{className:`p-4 rounded-lg bg-${r[s%4]}-50 dark:bg-${r[s%4]}-900/20`,children:[e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:t.count}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:n[t.intervention_type]||t.intervention_type})]},t.intervention_type)})})]}),l.interventions_summary.top_assets.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(j,{className:"h-5 w-5 text-orange-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a("analytics.topAssets")})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"#"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:a("assets.serialNumber")}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-500",children:a("analytics.interventionCount")})]})}),e.jsx("tbody",{children:l.interventions_summary.top_assets.map((t,s)=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-700/50",children:[e.jsx("td",{className:"py-3 px-4 text-sm text-gray-500",children:s+1}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"font-mono text-sm text-blue-600 hover:underline cursor-pointer",children:t.serial_number})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 rounded-full text-sm font-medium",children:t.intervention_count})})]},t.serial_number))})]})})]}),l.costs.by_type.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(X,{className:"h-5 w-5 text-purple-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a("analytics.costsByType")})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:a("common.type")}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-500",children:a("analytics.count")}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-500",children:a("analytics.totalCost")}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-500",children:a("analytics.avgCost")})]})}),e.jsx("tbody",{children:l.costs.by_type.map(t=>{var s,r;return e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-700/50",children:[e.jsx("td",{className:"py-3 px-4 font-medium text-gray-900 dark:text-gray-100",children:t.intervention_type}),e.jsx("td",{className:"py-3 px-4 text-right text-gray-600 dark:text-gray-400",children:t.count}),e.jsxs("td",{className:"py-3 px-4 text-right font-medium text-gray-900 dark:text-gray-100",children:["â‚¬",((s=t.total)==null?void 0:s.toLocaleString())||0]}),e.jsxs("td",{className:"py-3 px-4 text-right text-gray-600 dark:text-gray-400",children:["â‚¬",((r=t.average)==null?void 0:r.toFixed(2))||0]})]},t.intervention_type)})})]})})]})]})]})};export{Pe as default};
