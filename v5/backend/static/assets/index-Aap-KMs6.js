import{j as e}from"./vendor-ui-CHMJddlm.js";import{e as R,f,u as N,r as l,i as D}from"./vendor-react-B7WRoy5K.js";import{u as k}from"./useApi-Bp-7pDRC.js";import{D as z}from"./DataTable-DzGlaRkp.js";import{F as x}from"./FormField-CuL_p9Z6.js";import{C as B}from"./ConfirmDialog-OHK-43gw.js";import{u as w,X as U,Y as I,Z as T,t as P,C as _,h as q,c as A,$ as X,a0 as E,d as $,m as L,S as W,r as Y}from"./index-BmyZt_nq.js";import{S as y}from"./StatusBadge-C6HnAu2c.js";import"./vendor-charts-C5vizwv2.js";function te(){return e.jsxs(R,{children:[e.jsx(f,{index:!0,element:e.jsx(Z,{})}),e.jsx(f,{path:"new",element:e.jsx(S,{})}),e.jsx(f,{path:":id",element:e.jsx(G,{})}),e.jsx(f,{path:":id/edit",element:e.jsx(S,{})})]})}function Z(){var C;const{t:a}=w(),m=N(),o=k(),[p,i]=l.useState([]),[g,u]=l.useState(null),[v,b]=l.useState(!0),[n,d]=l.useState({tipo:"",ativo:"",search:""}),[c,j]=l.useState({open:!1,technician:null}),t=l.useCallback(async()=>{b(!0);try{const s=new URLSearchParams;n.tipo&&s.append("tipo",n.tipo),n.ativo&&s.append("ativo",n.ativo),n.search&&s.append("search",n.search);const h=await o.get(`/technicians?${s.toString()}`);i(h.technicians||[])}catch(s){console.error("Error loading technicians:",s)}finally{b(!1)}},[o,n]),r=l.useCallback(async()=>{try{const s=await o.get("/technicians/stats");u(s)}catch(s){console.error("Error loading stats:",s)}},[o]);l.useEffect(()=>{t(),r()},[t,r]);const M=async()=>{if(c.technician)try{await o.delete(`/technicians/${c.technician.id}`),j({open:!1,technician:null}),t(),r()}catch(s){alert(s.message||a("technicians.deactivateError"))}},F=[{key:"nome",label:a("technicians.name"),sortable:!0,render:s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"font-medium",children:s.nome})]})},{key:"tipo",label:a("common.type"),sortable:!0,render:s=>e.jsx(y,{status:s.tipo,colorMap:{interno:"blue",externo:"purple"}})},{key:"empresa",label:a("technicians.company"),sortable:!0,render:s=>s.empresa||"-"},{key:"especialidade",label:a("technicians.specialization"),sortable:!0,render:s=>s.especialidade||"-"},{key:"telefone",label:a("technicians.phone"),render:s=>e.jsxs("div",{className:"text-sm",children:[s.telefone&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"w-3 h-3"}),s.telefone]}),s.email&&e.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx(T,{className:"w-3 h-3"}),s.email]})]})},{key:"ativo",label:a("common.status"),render:s=>e.jsx(y,{status:s.ativo?"ativo":"inativo",colorMap:{ativo:"green",inativo:"gray"}})},{key:"actions",label:a("common.actions"),render:s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:h=>{h.stopPropagation(),m(`/technicians/${s.id}/edit`)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Editar",children:e.jsx(P,{className:"w-4 h-4"})}),e.jsx("button",{onClick:h=>{h.stopPropagation(),j({open:!0,technician:s})},className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Desativar",disabled:!s.ativo,children:e.jsx(_,{className:"w-4 h-4"})})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a("technicians.title")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:a("technicians.subtitle")})]}),e.jsxs("button",{onClick:()=>m("/technicians/new"),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(q,{className:"w-4 h-4"}),a("technicians.newTechnician")]})]}),g&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:e.jsx(A,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("common.total")}),e.jsx("p",{className:"text-xl font-bold",children:g.total})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900 rounded-lg",children:e.jsx(X,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("technicians.internal")}),e.jsx("p",{className:"text-xl font-bold",children:g.internos})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900 rounded-lg",children:e.jsx(E,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("technicians.external")}),e.jsx("p",{className:"text-xl font-bold",children:g.externos})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-teal-100 dark:bg-teal-900 rounded-lg",children:e.jsx($,{className:"w-5 h-5 text-teal-600 dark:text-teal-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("common.active")}),e.jsx("p",{className:"text-xl font-bold",children:g.ativos})]})]})})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(x,{name:"search",label:a("common.search"),type:"text",value:n.search,onChange:s=>d(h=>({...h,search:s})),placeholder:a("technicians.searchPlaceholder")}),e.jsx(x,{name:"tipo",label:a("common.type"),type:"select",value:n.tipo,onChange:s=>d(h=>({...h,tipo:s})),options:[{value:"",label:a("common.all")},{value:"interno",label:a("technicians.internal")},{value:"externo",label:a("technicians.external")}]}),e.jsx(x,{name:"ativo",label:a("common.status"),type:"select",value:n.ativo,onChange:s=>d(h=>({...h,ativo:s})),options:[{value:"",label:a("common.all")},{value:"true",label:a("common.active")},{value:"false",label:a("common.inactive")}]})]})}),e.jsx(z,{columns:F,data:p,loading:v,onRowClick:s=>m(`/technicians/${s.id}`),emptyMessage:a("technicians.noTechniciansFound")}),e.jsx(B,{open:c.open,title:a("technicians.deactivateTechnician"),message:a("technicians.confirmDeactivate",{name:(C=c.technician)==null?void 0:C.nome}),confirmLabel:a("technicians.deactivate"),variant:"danger",onConfirm:M,onCancel:()=>j({open:!1,technician:null})})]})}function S(){const{t:a}=w(),m=N(),{id:o}=D(),p=k(),i=!!o,[g,u]=l.useState(!1),[v,b]=l.useState(!1),[n,d]=l.useState({nome:"",tipo:"interno",empresa:"",telefone:"",email:"",especialidade:"",notas:"",ativo:!0});l.useEffect(()=>{i&&c()},[o]);const c=async()=>{u(!0);try{const t=await p.get(`/technicians/${o}`);d({nome:t.nome||"",tipo:t.tipo||"interno",empresa:t.empresa||"",telefone:t.telefone||"",email:t.email||"",especialidade:t.especialidade||"",notas:t.notas||"",ativo:!!t.ativo})}catch(t){console.error("Error loading technician:",t),m("/technicians")}finally{u(!1)}},j=async t=>{if(t.preventDefault(),!n.nome.trim()){alert(a("technicians.nameRequired"));return}b(!0);try{i?await p.put(`/technicians/${o}`,n):await p.post("/technicians",n),m("/technicians")}catch(r){alert(r.message||a("technicians.saveError"))}finally{b(!1)}};return g?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>m("/technicians"),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:e.jsx(L,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a(i?"technicians.editTechnician":"technicians.newTechnician")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:a(i?"technicians.editSubtitle":"technicians.newSubtitle")})]})]}),e.jsxs("form",{onSubmit:j,className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(x,{name:"nome",label:a("technicians.name"),type:"text",value:n.nome,onChange:t=>d(r=>({...r,nome:t})),required:!0,placeholder:a("technicians.namePlaceholder")}),e.jsx(x,{name:"tipo",label:a("common.type"),type:"select",value:n.tipo,onChange:t=>d(r=>({...r,tipo:t})),required:!0,options:[{value:"interno",label:a("technicians.internal")},{value:"externo",label:a("technicians.external")}]}),e.jsx(x,{name:"empresa",label:a("technicians.company"),type:"text",value:n.empresa,onChange:t=>d(r=>({...r,empresa:t})),placeholder:a("technicians.companyPlaceholder")}),e.jsx(x,{name:"especialidade",label:a("technicians.specialization"),type:"text",value:n.especialidade,onChange:t=>d(r=>({...r,especialidade:t})),placeholder:a("technicians.specializationPlaceholder")}),e.jsx(x,{name:"telefone",label:a("technicians.phone"),type:"text",value:n.telefone,onChange:t=>d(r=>({...r,telefone:t})),placeholder:a("technicians.phonePlaceholder")}),e.jsx(x,{name:"email",label:a("technicians.email"),type:"text",value:n.email,onChange:t=>d(r=>({...r,email:t})),placeholder:a("technicians.emailPlaceholder")}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(x,{name:"notas",label:a("technicians.notes"),type:"textarea",value:n.notas,onChange:t=>d(r=>({...r,notas:t})),placeholder:a("technicians.notesPlaceholder")})}),i&&e.jsx(x,{name:"ativo",label:a("common.status"),type:"checkbox",value:n.ativo,onChange:t=>d(r=>({...r,ativo:t}))})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("button",{type:"button",onClick:()=>m("/technicians"),className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 dark:border-gray-600 dark:hover:bg-gray-700",children:[e.jsx(W,{className:"w-4 h-4"}),a("common.cancel")]}),e.jsxs("button",{type:"submit",disabled:v,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Y,{className:"w-4 h-4"}),a(v?"common.saving":"common.save")]})]})]})]})}function G(){const{t:a}=w(),m=N(),{id:o}=D(),p=k(),[i,g]=l.useState(null),[u,v]=l.useState([]),[b,n]=l.useState(!0);l.useEffect(()=>{d()},[o]);const d=async()=>{n(!0);try{const[c,j]=await Promise.all([p.get(`/technicians/${o}`),p.get(`/technicians/${o}/interventions`)]);g(c),v(j.interventions||[])}catch(c){console.error("Error loading technician:",c),m("/technicians")}finally{n(!1)}};return b?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>m("/technicians"),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:e.jsx(L,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.nome}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(y,{status:i.tipo,colorMap:{interno:"blue",externo:"purple"}}),e.jsx(y,{status:i.ativo?"ativo":"inativo",colorMap:{ativo:"green",inativo:"gray"}})]})]})]}),e.jsxs("button",{onClick:()=>m(`/technicians/${o}/edit`),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(P,{className:"w-4 h-4"}),a("common.edit")]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:a("technicians.information")}),e.jsxs("dl",{className:"space-y-4",children:[i.empresa&&e.jsxs("div",{children:[e.jsxs("dt",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),a("technicians.company")]}),e.jsx("dd",{className:"font-medium",children:i.empresa})]}),i.especialidade&&e.jsxs("div",{children:[e.jsxs("dt",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),a("technicians.specialization")]}),e.jsx("dd",{className:"font-medium",children:i.especialidade})]}),i.telefone&&e.jsxs("div",{children:[e.jsxs("dt",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),a("technicians.phone")]}),e.jsx("dd",{className:"font-medium",children:i.telefone})]}),i.email&&e.jsxs("div",{children:[e.jsxs("dt",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),a("technicians.email")]}),e.jsx("dd",{className:"font-medium",children:i.email})]}),i.notas&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("technicians.notes")}),e.jsx("dd",{className:"text-sm",children:i.notas})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("technicians.totalInterventions")}),e.jsx("dd",{className:"font-medium",children:i.intervention_count||0})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:a("technicians.recentInterventions")}),u.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:a("technicians.noInterventions")}):e.jsx("div",{className:"space-y-3",children:u.slice(0,10).map(c=>e.jsxs("div",{onClick:()=>m(`/interventions/${c.id}`),className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:c.numero}),e.jsx("p",{className:"text-sm text-gray-500",children:c.asset_serial})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(y,{status:c.estado,colorMap:{em_curso:"yellow",concluida:"green",cancelada:"red"}}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(c.created_at).toLocaleDateString("pt-PT")})]})]},c.id))})]})]})]}):null}export{te as default};
