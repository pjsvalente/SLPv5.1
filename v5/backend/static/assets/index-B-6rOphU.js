import{j as e}from"./vendor-ui-CHMJddlm.js";import{r as c}from"./vendor-react-B7WRoy5K.js";import{u as Y}from"./useApi-DqL2_Wxn.js";import{u as G,z as W,a1 as q,d as f,I as k,c as D,a2 as S,b as H,y as J}from"./index-BLvAk8YV.js";import{F as C}from"./FormField-CKODJuda.js";import{S as R}from"./StatusBadge-BUwToTGD.js";import{R as g,P as p,a as u,C as m,T as h,B as I,X as T,Y as A,b as O,d as Q,L as V}from"./vendor-charts-C5vizwv2.js";const $={Operacional:"#22c55e","Manutencao Necessaria":"#f59e0b",manutencao:"#f59e0b","Em Reparação":"#f97316",Avariado:"#ef4444",ativo:"#22c55e",inativo:"#6b7280",Desativado:"#6b7280",abatido:"#dc2626",em_curso:"#3b82f6",concluida:"#22c55e",cancelada:"#ef4444",preventiva:"#22c55e",corretiva:"#f59e0b",substituicao:"#3b82f6",inspecao:"#8b5cf6",default:"#94a3b8"},y=a=>$[a]||$.default;function le(){const{t:a}=G(),{formatDate:P}=W(),j=Y(),[B,w]=c.useState(!0),[d,K]=c.useState(null),[i,E]=c.useState(null),[o,F]=c.useState("overview"),[b,_]=c.useState({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10),end:new Date().toISOString().slice(0,10)}),v=c.useCallback(async()=>{w(!0);try{const r=await j.get("/reports/stats");K(r)}catch(r){console.error("Error loading stats:",r)}finally{w(!1)}},[j]),N=c.useCallback(async()=>{try{const r=new URLSearchParams({start_date:b.start,end_date:b.end}),t=await j.get(`/reports/interventions?${r.toString()}`);E(t)}catch(r){console.error("Error loading intervention report:",r)}},[j,b]);c.useEffect(()=>{v()},[v]),c.useEffect(()=>{o==="interventions"&&N()},[o,N]);const L=[{id:"overview",label:a("reports.overview"),icon:q},{id:"interventions",label:a("navigation.interventions"),icon:f},{id:"assets",label:a("navigation.assets"),icon:k},{id:"technicians",label:a("navigation.technicians"),icon:D}],x=({active:r,payload:t})=>r&&t&&t.length?e.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg p-3",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:t[0].name}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t[0].value})]}):null,z=()=>{if(!d)return null;const r=Object.entries(d.assets_by_status).map(([s,l])=>({name:s,value:l,fill:y(s)})),t=Object.entries(d.interventions_by_status||{}).map(([s,l])=>({name:s==="em_curso"?a("interventions.statuses.inProgress"):s==="concluida"?a("interventions.statuses.completed"):s==="cancelada"?a("interventions.statuses.cancelled"):s,value:l,fill:y(s)})),n=Object.entries(d.interventions_by_type||{}).map(([s,l])=>({name:a(`interventions.types.${s}`)||s,value:l,fill:y(s)}));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-xl",children:e.jsx(k,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("reports.totalAssets")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:d.total_assets})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-xl",children:e.jsx(f,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("reports.totalInterventions")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:d.total_interventions})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-xl",children:e.jsx(D,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("reports.activeTechnicians")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:d.active_technicians})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 rounded-xl",children:e.jsx(H,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("reports.last30Days")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:d.recent_interventions})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:a("reports.assetsByStatus")}),r.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-64",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(p,{children:[e.jsx(u,{data:r,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:2,dataKey:"value",children:r.map((s,l)=>e.jsx(m,{fill:s.fill},`cell-${l}`))}),e.jsx(h,{content:e.jsx(x,{})})]})})}),e.jsx("div",{className:"flex flex-wrap justify-center gap-3 mt-4",children:r.map((s,l)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.fill}}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s.name,": ",s.value]})]},l))})]}):e.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:a("common.noData")})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:a("reports.interventionsByStatus")}),t.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-64",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(p,{children:[e.jsx(u,{data:t,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:2,dataKey:"value",children:t.map((s,l)=>e.jsx(m,{fill:s.fill},`cell-${l}`))}),e.jsx(h,{content:e.jsx(x,{})})]})})}),e.jsx("div",{className:"flex flex-wrap justify-center gap-3 mt-4",children:t.map((s,l)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.fill}}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s.name,": ",s.value]})]},l))})]}):e.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:a("common.noData")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:a("reports.interventionsByType")}),n.length>0?e.jsx("div",{className:"h-64",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(I,{data:n,layout:"vertical",children:[e.jsx(T,{type:"number",tick:{fill:"#6b7280"}}),e.jsx(A,{dataKey:"name",type:"category",width:100,tick:{fill:"#6b7280",fontSize:12}}),e.jsx(h,{content:e.jsx(x,{})}),e.jsx(O,{dataKey:"value",radius:[0,4,4,0],children:n.map((s,l)=>e.jsx(m,{fill:s.fill},`cell-${l}`))})]})})}):e.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:a("common.noData")})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:a("navigation.users")}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-6 bg-blue-50 dark:bg-blue-900/20 rounded-xl",children:[e.jsx("p",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:d.total_users}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:a("common.total")})]}),e.jsxs("div",{className:"text-center p-6 bg-green-50 dark:bg-green-900/20 rounded-xl",children:[e.jsx("p",{className:"text-4xl font-bold text-green-600 dark:text-green-400",children:d.active_users}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:a("common.active")})]}),e.jsxs("div",{className:"text-center p-6 bg-purple-50 dark:bg-purple-900/20 rounded-xl",children:[e.jsx("p",{className:"text-4xl font-bold text-purple-600 dark:text-purple-400",children:d.total_technicians}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:a("navigation.technicians")})]}),e.jsxs("div",{className:"text-center p-6 bg-orange-50 dark:bg-orange-900/20 rounded-xl",children:[e.jsx("p",{className:"text-4xl font-bold text-orange-600 dark:text-orange-400",children:d.recent_assets}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:a("dashboard.thisMonth")})]})]})]})]})]})},U=()=>{var t,n;const r=i!=null&&i.stats.by_type?Object.entries(i.stats.by_type).map(([s,l])=>({name:a(`interventions.types.${s}`)||s,value:l,fill:y(s)})):[];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-sm",children:e.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[e.jsx(C,{name:"start_date",label:a("reports.startDate"),type:"date",value:b.start,onChange:s=>_(l=>({...l,start:s}))}),e.jsx(C,{name:"end_date",label:a("reports.endDate"),type:"date",value:b.end,onChange:s=>_(l=>({...l,end:s}))}),e.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(S,{className:"w-4 h-4"}),a("common.refresh")]})]})}),i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("reports.totalInPeriod")}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:i.stats.total})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("interventions.statuses.completed")}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:((t=i.stats.by_status)==null?void 0:t.concluida)||0})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("interventions.statuses.inProgress")}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:((n=i.stats.by_status)==null?void 0:n.em_curso)||0})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(J,{className:"w-4 h-4 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("reports.averageDuration")})]}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:[i.stats.avg_duration,"h"]})]})]}),r.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:a("reports.interventionsByType")}),e.jsx("div",{className:"h-64",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(I,{data:r,children:[e.jsx(Q,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(T,{dataKey:"name",tick:{fill:"#6b7280",fontSize:12}}),e.jsx(A,{tick:{fill:"#6b7280"}}),e.jsx(h,{content:e.jsx(x,{})}),e.jsx(O,{dataKey:"value",radius:[4,4,0,0],children:r.map((s,l)=>e.jsx(m,{fill:s.fill},`cell-${l}`))})]})})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a("reports.recentInterventions")})}),e.jsxs("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:[i.interventions.slice(0,20).map(s=>e.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.numero}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.asset_serial||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(R,{status:s.tipo}),e.jsx(R,{status:s.estado}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:P(s.created_at)})]})]},s.id)),i.interventions.length===0&&e.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:a("common.noData")})]})]})]})]})},M=()=>{if(!d)return null;const r=Object.entries(d.assets_by_status).map(([t,n])=>({name:t,value:n,fill:y(t)}));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:a("reports.assetDistribution")}),r.length>0?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"h-64",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(p,{children:[e.jsx(u,{data:r,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"value",label:({name:t,percent:n})=>`${(n*100).toFixed(0)}%`,children:r.map((t,n)=>e.jsx(m,{fill:t.fill},`cell-${n}`))}),e.jsx(h,{content:e.jsx(x,{})})]})})}),e.jsx("div",{className:"grid grid-cols-2 gap-4 content-center",children:r.map((t,n)=>e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:t.fill}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:t.value}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 capitalize",children:t.name})]})]},n))})]}):e.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:a("common.noData")})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:a("reports.recentActivity")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"p-6 bg-blue-50 dark:bg-blue-900/20 rounded-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-blue-500 rounded-xl",children:e.jsx(k,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:d.recent_assets}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("reports.assetsCreatedLast30Days",{count:d.recent_assets})})]})]})}),e.jsx("div",{className:"p-6 bg-green-50 dark:bg-green-900/20 rounded-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-green-500 rounded-xl",children:e.jsx(f,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:d.recent_interventions}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("reports.last30Days")})]})]})})]})]})]})},X=()=>{if(!d)return null;const r=[{name:a("common.active"),value:d.active_technicians,fill:"#22c55e"},{name:a("common.inactive"),value:d.total_technicians-d.active_technicians,fill:"#94a3b8"}].filter(t=>t.value>0);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:a("navigation.technicians")}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-6 bg-blue-50 dark:bg-blue-900/20 rounded-xl",children:[e.jsx("p",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:d.total_technicians}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:a("common.total")})]}),e.jsxs("div",{className:"text-center p-6 bg-green-50 dark:bg-green-900/20 rounded-xl",children:[e.jsx("p",{className:"text-4xl font-bold text-green-600 dark:text-green-400",children:d.active_technicians}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:a("common.active")})]})]}),r.length>0&&e.jsx("div",{className:"h-48",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(p,{children:[e.jsx(u,{data:r,cx:"50%",cy:"50%",innerRadius:40,outerRadius:70,paddingAngle:2,dataKey:"value",children:r.map((t,n)=>e.jsx(m,{fill:t.fill},`cell-${n}`))}),e.jsx(h,{content:e.jsx(x,{})}),e.jsx(V,{})]})})})]})]})})};return B?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:a("reports.title")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:a("reports.subtitle")})]}),e.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsx(S,{className:"w-4 h-4"}),a("common.refresh")]})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx("nav",{className:"flex gap-1 overflow-x-auto",children:L.map(r=>{const t=r.icon;return e.jsxs("button",{onClick:()=>F(r.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors whitespace-nowrap ${o===r.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[e.jsx(t,{className:"w-4 h-4"}),r.label]},r.id)})})}),o==="overview"&&z(),o==="interventions"&&U(),o==="assets"&&M(),o==="technicians"&&X()]})}export{le as default};
