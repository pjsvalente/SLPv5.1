import{j as r}from"./vendor-ui-CHMJddlm.js";import{r as i}from"./vendor-react-B7WRoy5K.js";import{u as P,a as v,l as I,V as R,g as _,i as F,a1 as W,K as $,n as z,f as A,P as U,aq as G,Q,d as V,c as q,I as w,aP as K,aQ as J,aR as X,r as Y}from"./index-gVb7keNU.js";import"./vendor-charts-C5vizwv2.js";const Z={LayoutDashboard:K,Package:w,Users:q,Wrench:V,BookOpen:Q,HardHat:G,FileText:U,BarChart3:A,Settings:z,Database:$,Building2:W,MapPin:F,ScanLine:_,FileSpreadsheet:R},se=()=>{const{t:s}=P(),[N,x]=i.useState(!0),[h,k]=i.useState(!1),[f,l]=i.useState({type:"",text:""}),[c,p]=i.useState([]),[m,g]=i.useState(null),[D,u]=i.useState(null);i.useEffect(()=>{O()},[]);const O=async()=>{x(!0);try{const a=((await v.get("/settings/menu-items")).items||[]).filter(t=>!t.fixed_position);p(a)}catch(e){console.error("Error loading menu items:",e),l({type:"error",text:e.message||s("common.error")})}finally{x(!1)}},S=(e,a)=>{g(a),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",a),e.currentTarget instanceof HTMLElement&&(e.currentTarget.style.opacity="0.5")},M=e=>{g(null),u(null),e.currentTarget instanceof HTMLElement&&(e.currentTarget.style.opacity="1")},L=(e,a)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",a!==m&&u(a)},T=()=>{u(null)},E=(e,a)=>{if(e.preventDefault(),!m||m===a){g(null),u(null);return}const t=[...c],n=t.findIndex(d=>d.id===m),o=t.findIndex(d=>d.id===a);if(n===-1||o===-1)return;const[y]=t.splice(n,1);t.splice(o,0,y),t.forEach((d,b)=>{d.order=b+1}),p(t),g(null),u(null)};i.useCallback(e=>{g(e)},[]),i.useCallback(()=>{g(null),u(null)},[]);const j=(e,a)=>{const t=[...c],n=t.findIndex(d=>d.id===e);if(n===-1||a==="up"&&n===0||a==="down"&&n===t.length-1)return;const o=a==="up"?n-1:n+1,[y]=t.splice(n,1);t.splice(o,0,y),t.forEach((d,b)=>{d.order=b+1}),p(t)},C=async()=>{k(!0),l({type:"",text:""});try{const e=c.map(a=>a.id);await v.put("/settings/menu-order",{menu_order:e}),l({type:"success",text:s("settings.menuOrderSaved")||"Ordem dos menus guardada com sucesso"}),setTimeout(()=>l({type:"",text:""}),3e3)}catch(e){l({type:"error",text:e.message||s("common.error")})}finally{k(!1)}},B=async()=>{x(!0);try{const e=[...c].sort((a,t)=>a.default_order-t.default_order);e.forEach((a,t)=>{a.order=t+1}),p(e),await v.put("/settings/menu-order",{menu_order:[]}),l({type:"success",text:s("settings.menuOrderReset")||"Ordem dos menus reposta aos valores originais"}),setTimeout(()=>l({type:"",text:""}),3e3)}catch(e){l({type:"error",text:e.message||s("common.error")})}finally{x(!1)}},H=e=>s(`navigation.${e}`)||e;return N?r.jsx("div",{className:"flex justify-center p-8",children:r.jsx(I,{className:"h-8 w-8 animate-spin text-blue-600"})}):r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{children:r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:s("settings.menuOrderDescription")||"Arraste e solte os itens para reorganizar os menus da barra lateral. A nova ordem será aplicada após guardar."})}),f.text&&r.jsx("div",{className:`p-4 rounded-lg ${f.type==="error"?"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400":"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400"}`,children:f.text}),r.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-4",children:s("settings.menuItems")||"Itens do Menu"}),r.jsx("div",{className:"space-y-2",children:c.map(e=>{const a=Z[e.icon]||w,t=m===e.id,n=D===e.id;return r.jsxs("div",{draggable:!0,onDragStart:o=>S(o,e.id),onDragEnd:M,onDragOver:o=>L(o,e.id),onDragLeave:T,onDrop:o=>E(o,e.id),className:`
                  flex items-center gap-3 p-3 rounded-lg bg-white dark:bg-gray-800
                  border-2 transition-all duration-150 cursor-grab active:cursor-grabbing
                  ${t?"opacity-50 border-blue-500 shadow-lg":"border-transparent hover:border-gray-300 dark:hover:border-gray-600"}
                  ${n?"border-blue-400 bg-blue-50 dark:bg-blue-900/20":""}
                  shadow-sm hover:shadow-md
                `,children:[r.jsx("div",{className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 touch-none",children:r.jsx(J,{size:20})}),r.jsx("span",{className:"w-6 h-6 flex items-center justify-center rounded-full bg-gray-200 dark:bg-gray-600 text-xs font-medium text-gray-600 dark:text-gray-300",children:e.order}),r.jsx(a,{size:20,className:"text-slp-navy dark:text-white flex-shrink-0"}),r.jsx("span",{className:"flex-1 font-medium text-gray-900 dark:text-white",children:H(e.id)}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:()=>j(e.id,"up"),disabled:c.indexOf(e)===0,className:"p-1.5 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:s("common.moveUp")||"Mover para cima",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),r.jsx("button",{onClick:()=>j(e.id,"down"),disabled:c.indexOf(e)===c.length-1,className:"p-1.5 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:s("common.moveDown")||"Mover para baixo",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]},e.id)})}),r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-4",children:s("settings.menuOrderNote")||'Nota: O menu "Definições" permanece sempre no final da lista.'})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3",children:[r.jsxs("button",{onClick:B,disabled:h,className:"inline-flex items-center justify-center px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors",children:[r.jsx(X,{className:"h-4 w-4 mr-2"}),s("settings.resetOrder")||"Repor Ordem Original"]}),r.jsxs("button",{onClick:C,disabled:h,className:"inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:[h?r.jsx(I,{className:"h-4 w-4 mr-2 animate-spin"}):r.jsx(Y,{className:"h-4 w-4 mr-2"}),s("common.save")||"Guardar"]})]})]})};export{se as default};
